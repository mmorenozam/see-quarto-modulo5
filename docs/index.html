<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Mauricio Moreno, PhD">
  <title>see-quarto-modulo5 - Módulo 5: Breve introducción a la Estadística Inferencial en R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
  <script src="site_libs/tabwid-1.1.3/tabwid.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="images/icon.png" data-background-opacity="0.2" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Módulo 5: Breve introducción a la Estadística Inferencial en R</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Mauricio Moreno, PhD 
</div>
</div>
</div>

</section>
<section>
<section id="antes-de-comenzar" class="title-slide slide level1 center">
<h1>Antes de comenzar</h1>

</section>
<section id="generalidades" class="slide level2 smaller scrollable">
<h2>Generalidades</h2>
<div>
<ul>
<li class="fragment"><p>Uno de los objetivos de este curso es el evitar en la medida de lo posible el adentrarnos en teoría estadística. Entre los temas que dejaremos de lado están:</p>
<ul>
<li class="fragment"><p>Teoría de la probabilidad básica</p></li>
<li class="fragment"><p>Ley de los números grandes</p></li>
<li class="fragment"><p>Distribución muestral (o de muestreo)</p></li>
<li class="fragment"><p>Teorema del límite central</p></li>
<li class="fragment"><p>Descripción a detalle de la distribución normal</p></li>
<li class="fragment"><p>Descripción a detalle de otras distribuciones</p></li>
<li class="fragment"><p>Análisis de poder</p></li>
<li class="fragment"><p>Pruebas para valores discretos univariados</p>
<ul>
<li class="fragment">Prueba de bondad de ajuste de <span class="math inline">\(\chi^2\)</span></li>
</ul></li>
<li class="fragment"><p>Pruebas para valores discretos bivariados</p>
<ul>
<li class="fragment"><p>Prueba de independencia de <span class="math inline">\(\chi^2\)</span></p></li>
<li class="fragment"><p>Prueba exacta de Fisher</p></li>
</ul></li>
</ul></li>
<li class="fragment"><p>Sin embargo, es preciso el comenzar por algunas definiciones que inevitablemente serán necesarias para entender de mejor manera el resto del mismo.</p></li>
<li class="fragment"><p>Para esta sesión vamos a instalar nuevos paquetes:</p></li>
<li class="fragment"><p><code>install.packages(c("UsingR", "datarium", "rstatix", "car", "ggeffects", "emmeans", "multcomp", "multcompView", "olsrr", "ggpubr", "report", "parameters"))</code></p></li>
<li class="fragment"><p>Para quién esté interesado en un recurso para ver estos temas a profundidad, recomiendo el libro de <a href="https://learningstatisticswithr.com/" target="_blank">Danielle Navarro: <em>Learning Statistics with R</em></a></p></li>
</ul>
</div>
</section></section>
<section>
<section id="definiciones-básicas" class="title-slide slide level1 center">
<h1>Definiciones básicas</h1>

</section>
<section id="pasos-en-una-investigación" class="slide level2 smaller">
<h2>Pasos en una investigación</h2>
<div>
<ol type="1">
<li class="fragment"><p>¿Cuál es la pregunta qué deseo contestar? ¿cuál es mi objetivo?</p>
<ul>
<li class="fragment"><p><strong>Superioridad de mi tratamiento vs.&nbsp;un control</strong></p></li>
<li class="fragment"><p>No existe diferencia de mi tratamiento vs.&nbsp;un control</p></li>
<li class="fragment"><p>Equivalencia de mi tratamiento vs.&nbsp;una referencia</p></li>
<li class="fragment"><p>Asociación/dependencia/correlación entre una o más variables</p></li>
</ul></li>
<li class="fragment"><p>¿Qué tipo de estudio voy a llevar a cabo?</p>
<ul>
<li class="fragment"><p><strong>Experimental</strong></p></li>
<li class="fragment"><p>Observacional (*)</p></li>
</ul></li>
<li class="fragment"><p>¿Qué tipo de variables voy a medir?</p>
<ul>
<li class="fragment">Es mi respuesta continua o discreta</li>
</ul></li>
<li class="fragment"><p>¿Cuál es el dominio de esas variables?</p>
<ul>
<li class="fragment"><strong>Mi respuesta puede tomar cualquier valor real (positivo la mayor parte del tiempo)</strong></li>
</ul></li>
</ol>
</div>
</section>
<section id="pasos-en-una-investigación-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Pasos en una investigación</h2>
<div>
<ol start="4" type="1">
<li class="fragment"><p>¿Cuál es el dominio de esas variables? (continuación)</p>
<ul>
<li class="fragment"><p>Mi respuesta es un porcentaje (entre 0 y 100)</p></li>
<li class="fragment"><p>Mi respuesta es dicotómica (si/no)</p></li>
<li class="fragment"><p>Mi respuesta es un conteo (puede ser descrita con números enteros únicamente)</p></li>
<li class="fragment"><p>Mi respuesta es una proporción (valores entre 0 y 1)</p></li>
<li class="fragment"><p>Mi respuesta es categórica y representa un orden</p></li>
<li class="fragment"><p>Mi respuesta es categórica pero no representa un orden</p></li>
</ul></li>
<li class="fragment"><p>Si mi estudio es experimental, ¿qué diseño experimental voy a utilizar para levantar mis datos?</p>
<ul>
<li class="fragment"><p>Diseño completamente al azar (DCA)</p></li>
<li class="fragment"><p>Diseño de bloques completamente al azar (DBCA)</p></li>
<li class="fragment"><p>Diseño factorial completo (DFC)</p></li>
<li class="fragment"><p>Diseño cuadrado latino (DCL)</p></li>
</ul></li>
</ol>
</div>
</section>
<section id="pasos-en-una-investigación-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Pasos en una investigación</h2>
<div>
<ol start="6" type="1">
<li class="fragment"><p>Si mi estudio es observacional, ¿qué tipo de muestreo voy a llevar a cabo?</p>
<ul>
<li class="fragment"><p>Simple</p></li>
<li class="fragment"><p>Estratificado</p></li>
</ul></li>
<li class="fragment"><p>¿Cuál debería ser el tamaño de mi muestra?</p></li>
<li class="fragment"><p>¿Qué método(s) estadístico(s) voy a utilizar para analizar mis datos?</p></li>
</ol>
</div>
<div class="fragment">
<p><span style="color:red;"><strong>¿Qué No debería hacer antes de realizar una investigación?</strong></span></p>
</div>
<div class="fragment">
<ul>
<li>Empezarla sin haber pensado en todas las preguntas anteriores y esperar tener resultados estadísticamente válidos.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Un principio básico del método científico es el analizar los datos en base a un protocolo pre-establecido, y NO a decidir qué análisis llevar a cabo una vez que se ven los datos.</li>
</ul>
</div>
</section>
<section id="conceptos-básicos-de-los-diseños-experimentales" class="slide level2">
<h2>Conceptos básicos de los diseños experimentales</h2>
<div>
<ol type="1">
<li class="fragment"><p><strong>Repetición/Replicación:</strong> es la aplicación de los tratamientos a un determinado número de unidades experimentales (al menos 3). Puede ser igual al tamaño de muestra en ciertos casos.</p></li>
<li class="fragment"><p><strong>Aleatoriedad/Randomización:</strong> la asignación de unidades experimentales a un tratamiento debe realizarse al azar. Esto evita sesgos en las inferencias estadísticas al precautelar la independencia de los datos recolectados.</p></li>
<li class="fragment"><p><strong>Balance:</strong> se refiere al intentar el siempre tener un número igual de unidades experimentales en los tratamientos de interés. Datos no balanceados requieren de métodos estadísticos corregidos.</p></li>
</ol>
</div>
</section>
<section id="sobre-las-repeticiones" class="slide level2">
<h2>Sobre las repeticiones</h2>
<div class="fragment">
<p><strong>¿Son 3 repeticiones sufientes por tratamiento?, y ¿por qué 3?</strong></p>
<div>
<ul>
<li class="fragment"><p>Tres repeticiones son una convención que no ha sido demostrada satisfactoriamente, pero es ampliamente adoptada.</p></li>
<li class="fragment"><p>Una manera de determinar de manera fundamentada el número apropiado de repeticiones es llevar a cabo análisis de poder.</p>
<ul>
<li class="fragment"><p>Los análisis de poder requieren de información previa acerca de la variación esperada y el tamaño del efecto (diferencia entre tratamientos) a detectar.</p></li>
<li class="fragment"><p>Esto requiere de investigación bibliográfica, o conducción de ensayos piloto.</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="sobre-las-repeticiones-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Sobre las repeticiones</h2>
<div class="fragment">
<p><strong>¿Cuándo el número de repeticiones es igual al tamaño de la muestra?</strong></p>
<div>
<ul>
<li class="fragment"><p>Es común el confundir estos dos términos, más que nada por el contexto:</p></li>
<li class="fragment"><p>Cuando hablamos de un experimento con un solo factor (por ejemplo si tenemos una pregunta puntual cómo si la media aritmética de una muestra difiere de un valor establecido), el número de repeticiones coincide con el tamaño de la muestra.</p></li>
<li class="fragment"><p>Cuando hablamos de un experimento con dos o más tratamientos (un grupo control y otro experimental por ejemplo), el tamaño de la muestra refiere al total de unidades experimentales en todo el experimento, y el número de repeticiones se refiere al número de unidades experimentales <strong>por tratamiento</strong>.</p></li>
</ul>
</div>
</div>
</section>
<section id="sobre-el-tamaño-de-la-muestra" class="slide level2">
<h2>Sobre el tamaño de la muestra</h2>
<div class="fragment">
<p>Ya que hemos hablado de las repeticiones, <strong>¿has escuchado del número 30?</strong></p>
<div>
<ul>
<li class="fragment"><p>30 es el número <em>mágico</em> considerado como el mínimo de observaciones requeridas para llevar a cabo un experimento.</p></li>
<li class="fragment"><p>Como otros números en estadística, proviene de convenciones adoptadas a lo largo del tiempo más que de verdades comprobadas.</p></li>
<li class="fragment"><p>El número 30 ha sido demostrado como una <em>falacia</em> en <a href="https://stats.stackexchange.com/questions/2541/what-references-should-be-cited-to-support-using-30-as-a-large-enough-sample-siz" target="_blank">diversas ocasiones</a></p></li>
<li class="fragment"><p>Sin embargo, 30 es un buen punto de inicio si conocimiento bibliográfico o pre-experimentos no están disponibles para llevar a cabo análisis de poder.</p></li>
</ul>
</div>
</div>
</section>
<section id="muestras-poblaciones-y-muestreos" class="slide level2">
<h2>Muestras, poblaciones y muestreos</h2>
<div>
<ul>
<li class="fragment"><p><strong>Muestra</strong>: Es un conjunto de observaciones que provienen de una población de interés. Idealmente, esta debería ser lo suficientemente grande para hacer inferencias de esa población.</p></li>
<li class="fragment"><p><strong>Población</strong>: Es el conjunto de todas las posibles observaciones de las que tengamos interés en realizar inferencias. Es vital el definir adecuadamente sus características.</p></li>
<li class="fragment"><p><strong>Muestreo</strong>: Es el proceso por el cual obtendremos nuestra muestra para un estudio. En estudios experimentales, el muestreo se entiende también como el proceso de aleatorización/randomización de unidades experimentales.</p></li>
</ul>
</div>
</section>
<section id="muestreo-simple-sin-reemplazo" class="slide level2">
<h2>Muestreo simple sin reemplazo</h2>

<img data-src="images/simple1.png" width="900" class="r-stretch quarto-figure-center"><p class="caption">Tomado de <a href="https://learningstatisticswithr.com/" target="_blank"><em>Learning Statistics with R</em></a></p></section>
<section id="muestreo-simple-con-reemplazo" class="slide level2">
<h2>Muestreo simple con reemplazo</h2>

<img data-src="images/simple2.png" width="1020" class="r-stretch quarto-figure-center"><p class="caption">Tomado de <a href="https://learningstatisticswithr.com/" target="_blank"><em>Learning Statistics with R</em></a></p></section>
<section id="otros-tipos-de-muestreo" class="slide level2">
<h2>Otros tipos de muestreo</h2>
<div>
<ul>
<li class="fragment"><p><strong>Muestreo sistemático</strong>: consiste en tomar un determinado elemento de la población siguiendo un patrón. Por ejemplo, escoger los múltiplos de cuatro enumerados en una lista de posibles individuos de estudio (solía ser una práctica común en ensayos clínicos).</p></li>
<li class="fragment"><p><strong>Muestreo a conveniencia</strong>: consiste en incluir en el estudio a todos los elementos disponibles de la población de interés. Esto sucede sobre todo con poblaciones escasas o de dificil acceso (ejemplo, realizar estudios en comunidades LGBTIQ+).</p></li>
<li class="fragment"><p><strong>Muestreo estratificado</strong>: es una combinación del muestreo simple con los sujetos agrupados por alguna característica en común, por ejemplo sexo, edad, hábitat (suele ser usado en exit polls y conteos rápidos).</p></li>
</ul>
</div>
</section>
<section id="parámetros-poblacionales-y-estadísticos-muestrales" class="slide level2">
<h2>Parámetros poblacionales y estadísticos muestrales</h2>
<div>
<ul>
<li class="fragment"><p>Los parámetros poblacionales son características de toda una población (ejemplo, supongamos que el IQ de toda una población puede estar caracterizado por una media aritmética, <span class="math inline">\(\mu\)</span>, igual a 100, con una desviación estándar, <span class="math inline">\(\sigma\)</span>, igual a 15).</p></li>
<li class="fragment"><p>Si tomo una muestra de 100 individuos de dicha población, podría tener una media aritmética de esta muestra, <span class="math inline">\(\overline{X}\)</span>, igual a 101.4 y una desviación estándar de la muestra, <span class="math inline">\(s\)</span>, igual a 13.7.</p></li>
<li class="fragment"><p>En otras palabras, la <span class="math inline">\(\overline{X}\)</span> y <span class="math inline">\(s\)</span> son aproximaciones a los valores verdareros de <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> de esa población.</p></li>
</ul>
</div>
</section>
<section id="estimación-de-parámetros-de-población" class="slide level2 smaller">
<h2>Estimación de parámetros de población</h2>
<p><strong>Media aritmética</strong></p>
<table>
<colgroup>
<col style="width: 14%">
<col style="width: 52%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Símbolo</th>
<th>¿Qué es?</th>
<th>¿Sabemos qué es?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\overline{X}\)</span></td>
<td>Media aritmética de la muestra</td>
<td>Calculada de los datos</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mu\)</span></td>
<td>Verdadera media aritmética de la población</td>
<td>Casi nunca es conocida</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\mu}\)</span></td>
<td>Estimado de la media aritmética de la población</td>
<td>Sí, identica a <span class="math inline">\(\overline{X}\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\overline{X} = \frac{1}{n}\sum^{n}_{i=1}\left(X_i\right)
\]</span></p>
</section>
<section id="estimación-de-parámetros-de-población-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Estimación de parámetros de población</h2>
<p><strong>Desviación estándar</strong></p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 56%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Símbolo</th>
<th>¿Qué es?</th>
<th>¿Sabemos qué es?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s\)</span></td>
<td>Desviación estándar de la muestra</td>
<td>Calculada de los datos</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma\)</span></td>
<td>Verdadera desviación estándar de la población</td>
<td>Casi nunca es conocida</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\sigma}\)</span></td>
<td>Estimado de la deviación estándar de la población</td>
<td>Sí, pero no es igual a <span class="math inline">\(s\)</span></td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
s = \sqrt{\frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2}
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
\sigma = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2}
\]</span></p>
</div>
</div>
</section>
<section id="estimación-de-parámetros-de-población-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Estimación de parámetros de población</h2>
<p><strong>Varianza</strong></p>
<table>
<colgroup>
<col style="width: 15%">
<col style="width: 47%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Símbolo</th>
<th>¿Qué es?</th>
<th>¿Sabemos qué es?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^2\)</span></td>
<td>Varianza de la muestra</td>
<td>Calculada de los datos</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>Verdadera varianza de la población</td>
<td>Casi nunca es conocida</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td>Estimado de la varianza de la población</td>
<td>Sí, pero no es igual a <span class="math inline">\(s^2\)</span></td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
s^2 = \frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
\sigma^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2
\]</span></p>
</div>
</div>
</section>
<section id="intervalos-de-confianza" class="slide level2 smaller">
<h2>Intervalos de confianza</h2>
<div>
<ul>
<li class="fragment"><p>Cómo hemos visto, los estimados de las verdaderas <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> (<span class="math inline">\(\hat{\mu}\)</span> y <span class="math inline">\(\hat{\sigma}\)</span>) provienen de distribuciones de muestreo, y como tales, inherentemente poseen cierto grado de incertidumbre.</p></li>
<li class="fragment"><p>Los intervalos de confianza son medidas que nos permiten tener una idea de esa incertidumbre.</p></li>
<li class="fragment"><p>En el estudio de la distribución normal estándar tenemos el conocimiento que existe un 95% de chances que una cantidad normalmente distribuida colectada al azar, estará distante de la media aritmética entre <span class="math inline">\(\pm\)</span> 1.96 desviaciones estándar.</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\overline{X} - \left(1.96\times\frac{\sigma}{\sqrt{n}}\right) \leq \mu \leq \overline{X} + \left(1.96\times\frac{\sigma}{\sqrt{n}}\right)
\]</span></p>
<div>
<ul>
<li class="fragment">Y se interpreta como: <strong>con un 95% de confianza, podemos esperar que la media aritmética verdadera de la población de interés se encuentra contenida entre…</strong></li>
</ul>
</div>
</div>
<div class="fragment">
<p><span class="math display">\[
\text{IC}_{95}=\overline{X} \pm \left(1.96\times\frac{\sigma}{\sqrt{n}}\right)
\]</span></p>
</div>
</section>
<section id="intervalos-de-confianza-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Intervalos de confianza</h2>
<div>
<ul>
<li class="fragment"><p>Sin embargo, como mencionamos <span class="math inline">\(\sigma\)</span> es casi nunca conocido, y es necesario hacer una corrección a la fórmula anterior. La distribución normal trabaja bien baja la presunción de un número grande de observaciones.</p></li>
<li class="fragment"><p>En su lugar, en 1908 el estadístico <a href="https://en.wikipedia.org/wiki/Student%27s_t-distribution" target="_blank">Gosset</a> parametrizó una distribución para muestras pequeñas que asemeja a la normal. Con el tiempo, esta distribución adoptó el nombre de <em>Student</em>.</p></li>
<li class="fragment"><p>Y es precisamente que la fórmula anterior es corregida con la distribución de Student y así poder calcular intervalos de confianza para muestras pequeñas usando <span class="math inline">\(s\)</span> en lugar de <span class="math inline">\(\sigma\)</span>:</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\text{IC}_{95}=\overline{X} \pm \left(t_{n-1,\alpha/2}\times\frac{s}{\sqrt{n}}\right)
\]</span></p>
<div>
<ul>
<li class="fragment"><p>Donde el valor <span class="math inline">\(t_{n-1,\alpha/2}\)</span> refiere a:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(n-1\)</span>: los grados de libertad, igual al número de observaciones <span class="math inline">\(n\)</span> de la muestra, menos 1</p></li>
<li class="fragment"><p><span class="math inline">\(\alpha\)</span>: es el nivel de significancia (probabilidad de obtener un resultado erróneo por azar).</p></li>
<li class="fragment"><p>Estos valores en el pasado se encontraban tabulados en libros de texto, hoy contamos con R!</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="intervalos-de-confianza-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Intervalos de confianza</h2>
<div>
<ul>
<li class="fragment">Regresando al ejemplo del IQ, supongamos que medimos al azar el IQ de 5 personas y deseamos calcular el <span class="math inline">\(\text{IC}_{95}\)</span></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="1|2|3|4|5|6|7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>IQ_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">98</span>, <span class="dv">116</span>, <span class="dv">96</span>, <span class="dv">129</span>)   <span class="co"># muestra</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span>                                   <span class="co"># número de observaciones</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>t95 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span><span class="dv">1</span>)          <span class="co"># valor de Student para 4 grados de libertad al 5%</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>x <span class="ot">&lt;-</span> <span class="fu">mean</span>(IQ_muestra)                    <span class="co"># media aritmética de la muestra</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(IQ_muestra)                      <span class="co"># desviación estándar de la muestra</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>ls <span class="ot">&lt;-</span> x <span class="sc">+</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># límite superior del IC95</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>li <span class="ot">&lt;-</span> x <span class="sc">-</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># límite inferior del IC95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="intervalos-de-confianza-3" class="slide level2" data-autoanimate="true" data-visibility="uncounted">
<h2>Intervalos de confianza</h2>
<ul>
<li>Regresando al ejemplo del IQ, supongamos que medimos al azar el IQ de 5 personas y deseamos calcular el <span class="math inline">\(\text{IC}_{95}\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>IQ_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">98</span>, <span class="dv">116</span>, <span class="dv">96</span>, <span class="dv">129</span>)   <span class="co"># muestra</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span>                                   <span class="co"># número de observaciones</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>t95 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span><span class="dv">1</span>)          <span class="co"># valor de Student para 4 grados de libertad al 5%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>x <span class="ot">&lt;-</span> <span class="fu">mean</span>(IQ_muestra)                    <span class="co"># media aritmética de la muestra</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(IQ_muestra)                      <span class="co"># desviación estándar de la muestra</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>ls <span class="ot">&lt;-</span> x <span class="sc">+</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># límite superior del IC95</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>li <span class="ot">&lt;-</span> x <span class="sc">-</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># límite inferior del IC95</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Con un 95% de confianza podemos esperar que la verdadera media aritmética de IQ de esta población se encuentre entre ["</span>,<span class="fu">round</span>(li,<span class="dv">0</span>),<span class="st">", "</span>,<span class="fu">round</span>(ls,<span class="dv">0</span>),<span class="st">"]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Con un 95% de confianza podemos esperar que la verdadera media aritmética de IQ de esta población se encuentre entre [98, 118]"</code></pre>
</div>
</div>
</section>
<section id="autoevaluación" class="slide level2 smaller scrollable">
<h2>Autoevaluación</h2>
<p>La concentración media de glucosa en ratones sanos se ha estimado en un rango entre 80 y 100 mg/dL. En un experimento, se han medido las siguientes concentraciones de glucosa en 10 ratones de una línea genética se presume tendría potencial de ser modelo de hiperglucemia después de unas cuantas más generaciones de cruce selectivo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:70%;">
<ol type="1">
<li>La media aritmética <span class="math inline">\(\overline{X}\)</span> de la muestra es:</li>
</ol>
</div><div class="column" style="width:30%;">
<ol type="a">
<li>89.5</li>
<li>85.5</li>
<li>91.8</li>
<li>100.1</li>
</ol>
</div>
</div>
<div class="columns">
<div class="column" style="width:70%;">
<ol start="2" type="1">
<li>La desviación de estándar <span class="math inline">\(s\)</span> de la muestra es</li>
</ol>
</div><div class="column" style="width:30%;">
<ol type="a">
<li>30.6</li>
<li>18.0</li>
<li>15.6</li>
<li>22.9</li>
</ol>
</div>
</div>
<div class="columns">
<div class="column" style="width:70%;">
<ol start="3" type="1">
<li>El intervalo de confianza (bajo la distribución de Student) es</li>
</ol>
</div><div class="column" style="width:30%;">
<ol type="a">
<li>[81.4, 95.3]</li>
<li>[80.4, 97.3]</li>
<li>[83.7, 95.3]</li>
<li>[83.7, 100.3]</li>
</ol>
</div>
</div>
</section></section>
<section>
<section id="pruebas-de-hipótesis" class="title-slide slide level1 center">
<h1>Pruebas de hipótesis</h1>

</section>
<section id="hipótesis-de-investigación-vs.-hipótesis-estadísticas" class="slide level2 smaller">
<h2>Hipótesis de investigación vs.&nbsp;hipótesis estadísticas</h2>
<div>
<ul>
<li class="fragment"><p>Una hipótesis de investigación gira alrededor del desarrollar una conclusión científica acerca de un tema de interés del investigador. Ejemplos: <em>el fumar causa cáncer</em>, <em>las vacunas causan/previenen enfermedades</em>.</p>
<ul>
<li class="fragment">Es decir, pueden tener una naturaleza subjetiva, que expresan la pregunta del investigador de una manera general sin mayor descripción del ¿cómo? voy a probar o descartarla, ni ¿en qué extensión?.</li>
</ul></li>
<li class="fragment"><p>Hipótesis estadísticas, por el contrario, deben ser matemáticamente precisas y basadas en las características de los datos que recolectemos con el fin de probar o descartar la hipótesis de investigación.</p>
<ul>
<li class="fragment"><p>Cómo es de esperar, el probar o descartar una hipótesis estadística será únicamente válida para la población sobre la cual una muestra fue tomada.</p></li>
<li class="fragment"><p>Es ahí donde radica la importancia en definir la población sujeto de estudio de manera planificada con el objetivo de que cumpla tantos detalles sean necesarios de la hipótesis de investigación. Ejemplo, el modelo animal más usado es el ratón. Si bien es cierto constituye uno de los primeros pasos en el desarrollo de muchas investigaciones, los hallazgos en ratones NO pueden ser inmediatamente atribuibles a suceder en seres humanos.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="hipótesis-nula-y-alternativa" class="slide level2 smaller">
<h2>Hipótesis nula y alternativa</h2>
<div>
<ul>
<li class="fragment"><p>La formulación de hipótesis estadísticas puede reducirse a establer preguntas de investigación en forma de las hipótesis nula y alternativa.</p></li>
<li class="fragment"><p>Supongamos que tenemos dos grupos experimentales para probar la eficiencia de un nuevo procedimiento quirúrgico. Un grupo de pacientes será sometido a la intervención tradicional (control), y el otro grupo al nuevo procedimiento (experimental).</p>
<ul>
<li class="fragment"><p>La hipótesis nula (<span class="math inline">\(H_0\)</span>) establece que: no existe diferencia entre el grupo control y el grupo experimental,</p></li>
<li class="fragment"><p>Mientras que la hipótesis alternativa (<span class="math inline">\(H_a\)</span>) establece que: sí existe differencia entre ambos.</p></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c = \mu_e&amp; H_0&amp; : \mu_c- \mu_e =0 \\
H_a&amp; : \mu_c \neq \mu_e&amp; H_a&amp; : \mu_c- \mu_e \neq 0
\end{align}\]</span>
</div>
</section>
<section id="tipos-de-errores" class="slide level2">
<h2>Tipos de errores</h2>
<div>
<ul>
<li class="fragment">Al llevar a cabo pruebas de hipótesis pueden ocurrir errores</li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{array}{|c||c||c|}
  \hline
  &amp; \text{Acepta }H_{0} &amp; \text{Rechaza }H_{0} \\
  \hline
H_{0}\text{ es verdadera} &amp; \text{Desición correcta} &amp; \text{Error tipo I} \\
  H_{0}\text{ es falsa} &amp; \text{Error tipo II} &amp; \text{Desición correcta} \\
   \hline
\end{array}\]</span>
</div>
<div class="fragment">
<ul>
<li>¿De qué depende que aceptemos correctamente o no la hipótesis nula?</li>
</ul>
</div>
<div class="fragment">
<p>Las pruebas estadísticas dependen de la cantidad de variación y la diferencia entre tratamientos a detectar (<strong>tamaño del efecto</strong>). La solución: aumentar el número de observaciones</p>
</div>
</section>
<section id="poder-de-una-prueba-estadística" class="slide level2 smaller">
<h2>Poder de una prueba estadística</h2>
<div>
<ul>
<li class="fragment"><p>El poder de una prueba estadística es la probabilidad de rechazar la hipótesis nula cuando esta es de hecho falsa.</p></li>
<li class="fragment"><p>Se puede derivar de la tabla anterior</p></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{array}{|c||c||c|}
  \hline
  &amp; \text{Acepta }H_{0} &amp; \text{Rechaza }H_{0} \\
  \hline
H_{0}\text{ es verdadera} &amp; 1-\alpha\text{ (Prob. decisión correcta)} &amp; \alpha\text{ (Taza Error tipo I)} \\
  H_{0}\text{ es falsa} &amp; \beta\text{ (Taza Error tipo II)} &amp; 1-\beta\text{ (Poder)} \\
   \hline
\end{array}\]</span>
</div>
<div class="fragment">
<ul>
<li><p>En la práctica, existen fórmulas cerradas para la determinación del número mínimo de observaciones para alcanzar un poder adecuado (<span class="math inline">\(\ge\)</span> 80%).</p></li>
<li><p>A este procedimiento se le conoce como análisis de poder. Este se lo puede realizar en R, por supuesto, pero no es parte de nuestro curso.</p></li>
</ul>
</div>
</section>
<section id="tamaño-del-efecto" class="slide level2 smaller">
<h2>Tamaño del efecto</h2>
<div>
<ul>
<li class="fragment"><p>El tamaño del efecto (<span class="math inline">\(\theta\)</span>) es un valor que por lo general es determinado por el investigador y que puede ser la diferencia de interés a detectar en una prueba estadística.</p></li>
<li class="fragment"><p>Por simplicidad, vamos a enfocarnos en el ejercicio de los ratones. Supongamos que el investigador está interesado en saber cual sería el número de ratones que necesitaría para con un 80% de poder, encontrar una diferencia entre la media aritmética de su muestra y un valor que considera razonable chequear igual a 100 mg/dL. Este último valor viene a ser el <span class="math inline">\(\theta\)</span>.</p></li>
<li class="fragment"><p>Las hipótesis de esta prueba se verían así</p></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r = \theta \\
H_a&amp; : \mu_c- \mu_r \neq \theta
\end{align}\]</span>
<div>
<ul>
<li class="fragment"><p>Sin embargo, la pregunta del investigador aún está incompleta. <span class="fragment"><strong>A tu criterio, ¿qué falta?</strong></span></p></li>
<li class="fragment"><p>Al formular hipótesis, hemos considerado el caso más simple hasta el momento. Pero recordando la idea inicial del experimento de los ratones, la opción lógica sería preguntarnos ¿cuántos ratones necesitamos para estar seguros que la población sea hiperglucémica? (cuyo valor de glucosa en sangre esté por encima del de un ratón sano)</p></li>
</ul>
</div>
</div>
</section>
<section id="pruebas-de-dos-colas" class="slide level2">
<h2>Pruebas de dos colas</h2>
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r = \theta \\
H_a&amp; : \mu_c- \mu_r \neq \theta
\end{align}\]</span>

<img data-src="images/dcolas.gif" width="400" class="r-stretch quarto-figure-center"><p class="caption">Imagen tomada de <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" target="_blank"><em>UCLA: Advanced Research Computing</em></a></p></section>
<section id="pruebas-de-una-cola" class="slide level2">
<h2>Pruebas de una cola</h2>
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r \ge \theta \\
H_a&amp; : \mu_c- \mu_r &lt; \theta
\end{align}\]</span>

<img data-src="images/ucolagreat.gif" width="400" class="r-stretch quarto-figure-center"><p class="caption">Imagen tomada de <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" target="_blank"><em>UCLA: Advanced Research Computing</em></a></p></section>
<section id="pruebas-de-una-cola-1" class="slide level2" data-visibility="uncounted">
<h2>Pruebas de una cola</h2>
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r \le \theta \\
H_a&amp; : \mu_c- \mu_r &gt; \theta
\end{align}\]</span>

<img data-src="images/ucolaless.gif" width="400" class="r-stretch quarto-figure-center"><p class="caption">Imagen tomada de <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" target="_blank"><em>UCLA: Advanced Research Computing</em></a></p></section>
<section id="valores-críticos-y-el-valor-p" class="slide level2">
<h2>Valores críticos y el valor p</h2>
<div>
<ul>
<li class="fragment"><p>Pero ¿cómo sabemos si una hipótesis es aceptada o rechazada?</p></li>
<li class="fragment"><p>Regresando al concepto de los intervalos de confianza, los cuartiles de la distribución de Student calculados a un nivel de significancia <span class="math inline">\(\alpha\)</span> son valores críticos sobre los cuales se determina el rechazo o aceptación de la hipótesis nula.</p></li>
<li class="fragment"><p>El valor p, describe que tan probable sería observar resultados de la prueba asumiendo que la hipótesis nula no hubiese sido rechazada. Por ello, a menores valores p, mayor la diferencia estadística con respecto a la hipótesis alternativa.</p></li>
</ul>
</div>
</section>
<section id="antes-de-continuar" class="slide level2">
<h2>Antes de continuar</h2>

<img data-src="images/cena.png" class="r-stretch quarto-figure-center"><div class="footer">
<p>Imagen tomada de <a href="https://arbor-analytics.com/post/2022-10-10-p-ing-in-the-woods-p-values-in-forest-science/" target="_blank">aquí</a></p>
</div>
</section>
<section id="antes-de-continuar-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment"><p>El umbral de 0.05 es una convención arbitraria <a href="https://www.bmj.com/rapid-response/2011/11/03/origin-5-p-value-threshold#:~:text=statistician%20RA%20Fisher%20in%201926%20%5B1%5D." target="_blank">creada por Fischer</a> en los inicios de la estadística moderna.</p></li>
<li class="fragment"><p>Lastimosamente, se ha generalizado la idea de que por más mínima sea la diferencia con respecto a 0.05, esta representa la diferencia entre publicar o no (en el campo académico), entre lanzar o no un nuevo fármaco/producto al mercado (en la industria).</p></li>
<li class="fragment"><p>En 2014, debido a un fallo de la <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5017929/#:~:text=A%20statistically%20significant%20test%20result,that%20no%20effect%20was%20observed." target="_blank">corte suprema de justicia de los Estados Unidos</a> que le dio la potestad a los inversionistas de farmaceúticas a demandarlas por fallar en reportar efectos secundarios de sus productos a pesar de haber sido hallados estadísticamente no significativos, la Asociación Americana de Estadística (ASA) se vio en la necesidad de definir más exhaustivamente el concepto del valor p.</p></li>
<li class="fragment"><p>Entre las recomendaciones de la ASA, se enfatizó el dar mayor prioridad a la estimación de otros estadísticos complementarios al valor p, tales como intervalos de confianza u otros provenientes de la estadística Bayesiana (intervalos de credibilidad, factores de Bayes).</p></li>
<li class="fragment"><p>Esta última (estadística Bayesiana), ofrece una interpretación más natural al referirnos a los resultados en términos de probabilidades y no en números arbirtrarios como el valor p.</p></li>
<li class="fragment"><p>En resumen, una investigación no es inútil si el valor p sobrepasa o está por debajo de 0.05 por cantidades pequeñas.</p></li>
</ul>
</div>
</section>
<section id="antes-de-continuar-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment"><p>En su lugar, en escenarios en que el valor p está alejado por una décima o varias centésimas de 0.05, los resultados deberían interpretarse como indeterminados para generalizar sobre la población objeto de estudio y específicos a las condiciones experimentales (análisis estadísticos, instrumentos de medición, etc) bajo las cuales fueron tomadas y modeladas las mediciones.</p></li>
<li class="fragment"><p>En el contexto de los modelos estadísticos que veremos más adelante, esto ha derivado en un “temor” del investigador cuando los resultados no pasan los chequeos de los supuestos sobre los que estos modelos se cimentan. Sobre todo cuando el valor p dista de 0.05 por ínfimas cantidades.</p></li>
<li class="fragment"><p>Esto puede llevar a malas prácticas científicas tales como: no reportar el resultado de los chequeos, blindar los datos, escoger “outliers” y removerlos y en el peor de los casos, manipular los datos para tratar de acomodar nuestros datos a estos chequeos.</p></li>
<li class="fragment"><p>Todo lo que he mencionado, no solamente constituyen casos de mala conducta científica, sino lo que hoy en día se le conoce como <em>p hacking</em> (que se puede resumir a torturar los datos hasta que nos confiesen una verdad agradable a nuestros propósitos).</p></li>
</ul>
</div>
</section></section>
<section>
<section id="pruebas-estadísticas-paramétricas" class="title-slide slide level1 center">
<h1>Pruebas estadísticas paramétricas</h1>

</section>
<section id="datos-para-esta-sección" class="slide level2">
<h2>Datos para esta sección</h2>
<div>
<ul>
<li class="fragment"><p>Para esta sección del curso usaremos algunas de las tablas de datos del libro <a href="https://www.routledge.com/Using-R-for-Introductory-Statistics/Verzani/p/book/9781466590731#:~:text=Resources%20Support%20Material-,Book%20Description,small%2C%20task%2Doriented%20steps." target="_blank"><em>Using R for Introductory Statistics</em></a>, como también del paquete <code>datarium</code>.</p></li>
<li class="fragment"><p>Para ello, instalaremos los paquetes de R: <code>UsingR</code> y <code>datarium</code>.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(UsingR)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(datarium)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="pruebas-t" class="slide level2 smaller">
<h2>Pruebas t</h2>
<div>
<ul>
<li class="fragment"><p>Las pruebas t son usadas para encontrar la diferencia entre dos medias aritméticas.</p></li>
<li class="fragment"><p>La <span class="math inline">\(H_0\)</span> en estas pruebas es que las medias aritméticas son las mismas.</p></li>
<li class="fragment"><p>Se rechaza la <span class="math inline">\(H_0\)</span> cuando el valor p resultante es <span class="math inline">\(&lt;\)</span> 0.05</p></li>
<li class="fragment"><p>Existen tres tipos de pruebas t</p>
<ul>
<li class="fragment"><p>Pruebas t de una muestra</p></li>
<li class="fragment"><p>Pruebas t de muestras independientes</p></li>
<li class="fragment"><p>Pruebas t de muestras emparejadas</p></li>
</ul></li>
<li class="fragment"><p>Estas pruebas fueron desarrolladas bajo la suposición de la <strong>normalidad</strong> y de <strong>homogeneidad de las varianzas</strong>.</p></li>
<li class="fragment"><p>De acuerdo al teorema del límite central, muestras grandes casi aseguran la normalidad.</p></li>
<li class="fragment"><p>Cuando el número de observaciones en una muestra es pequeño, es recomendable llevar a cabo un test de normalidad para decidir si es posible una prueba t o una de sus alternativas.</p></li>
</ul>
</div>
</section>
<section id="normalidad-de-una-muestra" class="slide level2">
<h2>Normalidad de una muestra</h2>
<div>
<ul>
<li class="fragment"><p>Antes de llevar a cabo las pruebas t, hemos mencionado sus supuestos. Por ello, es aconsejable el siempre realizar estas pruebas antes de usarlas.</p></li>
<li class="fragment"><p>Existen dos tipos de pruebas para establecer si una muestra es normalmente distribuida o no</p>
<ul>
<li class="fragment"><p>Indirectamente: gráfico Q-Q</p></li>
<li class="fragment"><p>Prueba formal de normalidad (ejemplo: Shapiro-Wilk)</p></li>
</ul></li>
<li class="fragment"><p><strong>En el caso del ANOVA</strong>, es importante enfatizar que estas pruebas no necesariamente tienen que hacerse antes de la prueba, como ya veremos más adelante.</p></li>
</ul>
</div>
</section>
<section id="gráfico-q-q" class="slide level2">
<h2>Gráfico Q-Q</h2>
<div>
<ul>
<li class="fragment"><p>El gráfico Q-Q es una prueba visual indirecta de la normalidad.</p></li>
<li class="fragment"><p>Consiste en crear un gráfico de dispersión entre los valores observados de una muestra vs.&nbsp;los valores que deberían estos tener si siguieran una distribución normal.</p></li>
<li class="fragment"><p>Mientras en el gráfico de dispersión los puntos más se distribuyan a lo largo de una diagonal, más cercanos están los datos de la muestra a seguir un distribución normal.</p></li>
<li class="fragment"><p>Su desventaja es que es muy subjetivo, y a menudo requiere una prueba formal para poder confirmarlo.</p></li>
</ul>
</div>
</section>
<section id="gráfico-q-q-1" class="slide level2" data-visibility="uncounted">
<h2>Gráfico Q-Q</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># simulamos 30 observaciones de una normal estandar</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">qqnorm</span>(y)                             <span class="co"># producimos el gráfico Q-Q</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gráfico-q-q-2" class="slide level2" data-visibility="uncounted">
<h2>Gráfico Q-Q</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># simulamos 30 observaciones de una normal estandar</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">qqnorm</span>(y)                             <span class="co"># producimos el gráfico Q-Q</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-8-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="prueba-de-normalidad-shapiro-wilk" class="slide level2">
<h2>Prueba de normalidad Shapiro-Wilk</h2>
<div>
<ul>
<li class="fragment"><p>La <span class="math inline">\(H_0\)</span> de esta prueba (y del resto de pruebas formales de normalidad) es que un set de <span class="math inline">\(n\)</span> observaciones es normalmente distribuido.</p></li>
<li class="fragment"><p>Otro conocido método es Kolmogorov-Smirnov. Sin embargo, Shapiro-Wilk es más apropiado para cuando el número de muestras es menor a 50.</p></li>
<li class="fragment"><p>Para ilustrar su uso, chequeemos la normalidad de los datos que simulamos anteriormente</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">shapiro.test</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  y
W = 0.97894, p-value = 0.7966</code></pre>
</div>
</div>
</div>
</section>
<section id="prueba-de-homogeneidad-de-las-varianzas" class="slide level2 smaller">
<h2>Prueba de homogeneidad de las varianzas</h2>
<div>
<ul>
<li class="fragment"><p>En el caso de comparaciones entre las medias de dos grupos, la homogeneidad de varianzas puede chequearse usando la prueba F.</p></li>
<li class="fragment"><p>La prueba t de una muestra no requiere chequear este supuesto.</p></li>
<li class="fragment"><p>Para ilustrar su uso, creemos otro vector con datos simulados. En este caso, un igual número de observaciones con la misma desviación estándar pero diferente media:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">var.test</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  x and y
F = 1, num df = 29, denom df = 29, p-value = 1
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4759648 2.1009958
sample estimates:
ratio of variances 
                 1 </code></pre>
</div>
</div>
</div>
</section>
<section id="supuestos-en-la-práctica" class="slide level2 scrollable">
<h2>Supuestos en la práctica</h2>
<div>
<ul>
<li class="fragment"><p>Usemos las pruebas con datos reales, esta vez con la tabla de datos <code>crime</code> del paquete <code>Using R</code>.</p></li>
<li class="fragment"><p>Esta tabla de datos contiene registros de las tasas de crimen (# de reportes/100000 habitantes) en 50 estados en los Estados Unidos correspondiente a los años 1983 y 1993.</p></li>
<li class="fragment"><p>Sin enfocarnos por el momento en que prueba t específica usaremos, limitémonos a chequear la normalidad y la homogeneidad de varianzas entre las tasas de crimen registradas en 1983 y 1993.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">data</span>(crime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Normalidad 1983</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">shapiro.test</span>(crime<span class="sc">$</span>y1983)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  crime$y1983
W = 0.77333, p-value = 1.827e-07</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Normalidad 1993</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">shapiro.test</span>(crime<span class="sc">$</span>y1993)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  crime$y1993
W = 0.77348, p-value = 1.841e-07</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Homogeneidad de las varianzas</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">var.test</span>(crime<span class="sc">$</span>y1983, crime<span class="sc">$</span>y1993)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  crime$y1983 and crime$y1993
F = 0.49163, num df = 50, denom df = 50, p-value = 0.01342
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.2806163 0.8613069
sample estimates:
ratio of variances 
         0.4916266 </code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/calmarno.jpg"></p>
</figure>
</div>
</div>
</section>
<section id="transformación-de-variables" class="slide level2">
<h2>Transformación de variables</h2>
<div>
<ul>
<li class="fragment"><p>A menudo nos encontraremos con conjuntos de observaciones que no cumplen uno o ninguno de los supuestos.</p></li>
<li class="fragment"><p>Antes de considerar pruebas no paramétricas, podemos intentar transformaciones de variables para regresar al mundo de las pruebas paramétricas. Las transformaciones más usadas son:</p>
<ul>
<li class="fragment"><p>La raíz cuadrada (si los datos no contienen números negativos)</p></li>
<li class="fragment"><p>Elevar al cuadrado</p></li>
<li class="fragment"><p>Logaritmo (si los datos solo incluyen números reales positivos, cero excluido)</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="transformación-de-variables-1" class="slide level2" data-visibility="&quot;uncounted">
<h2>Transformación de variables</h2>
<div>
<ul>
<li class="fragment"><p>Existe un método más sofisticado para “normalizar” una muestra. <span class="fragment"><a href="https://www.r-bloggers.com/2022/10/box-cox-transformation-in-r/">La transformación de Box-Cox.</a></span></p></li>
<li class="fragment"><p>Cuando se trabaja con muestras transformadas, el objetivo es poder revertir la transformación a las unidades reales para así poder hacer conclusiones sobre las inferencias estadísticas.</p></li>
<li class="fragment"><p>En otras palabras, una misma transformación <strong>debe</strong> aplicarse a todos los grupos a ser comparados. <strong>NO</strong> tiene ningún sentido tratar de realizar inferencias entre grupos donde se hayan usado distintas transformaciones para normalizarlos.</p></li>
<li class="fragment"><p>Si el número de observaciones es muy reducido, usualmente no hay transformación que funcione y se recomienda usar directamente pruebas no paramétricas.</p></li>
</ul>
</div>
</section>
<section id="transformación-de-variables-2" class="slide level2 scrollable" data-visibility="&quot;uncounted">
<h2>Transformación de variables</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Raíz cuadrada</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">shapiro.test</span>(<span class="fu">sqrt</span>(crime<span class="sc">$</span>y1983))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  sqrt(crime$y1983)
W = 0.9411, p-value = 0.01359</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Elevar al cuadrado</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">shapiro.test</span>(crime<span class="sc">$</span>y1983<span class="sc">^</span><span class="dv">2</span>)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  crime$y1983^2
W = 0.38921, p-value = 2.954e-13</code></pre>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Logaritmo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">shapiro.test</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  log(crime$y1983)
W = 0.98076, p-value = 0.5713</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Chequeemos con el otro grupo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">shapiro.test</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1993))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  log(crime$y1993)
W = 0.96191, p-value = 0.1006</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Homogeneidad de las varianzas con transformación logarítmica</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">var.test</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983), <span class="fu">log</span>(crime<span class="sc">$</span>y1993))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  log(crime$y1983) and log(crime$y1993)
F = 0.84048, num df = 50, denom df = 50, p-value = 0.5412
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4797393 1.4724831
sample estimates:
ratio of variances 
         0.8404808 </code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/kid.jpg"></p>
</figure>
</div>
</div>
</section>
<section id="prueba-t-de-una-muestra" class="slide level2">
<h2>Prueba t de una muestra</h2>
<div>
<ul>
<li class="fragment"><p>Es usada para comparar la media aritmética de una muestra con un valor conocido (un estándar por ejemplo).</p></li>
<li class="fragment"><p>Por lo general el valor al que se va a comparar proviene de referencias bibliográficas, pre-experimentos o supociones fundamentadas.</p></li>
<li class="fragment"><p>En este caso, el supuesto que debe cumplirse es el de la normalidad de los datos</p></li>
<li class="fragment"><p>Regresando a nuestro ejemplo de los ratones, determinemos si la media de la muestra es mayor al límite superior de glucosa de ratones saludables.</p></li>
</ul>
</div>
</section>
<section id="prueba-t-de-una-muestra-1" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t de una muestra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>ratest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(glc_rat,</span>
<span id="cb29-3"><a href="#cb29-3"></a>       <span class="at">mu =</span> <span class="dv">100</span>,</span>
<span id="cb29-4"><a href="#cb29-4"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a>ratest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prueba-t-de-una-muestra-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t de una muestra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>ratest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(glc_rat,</span>
<span id="cb30-3"><a href="#cb30-3"></a>       <span class="at">mu =</span> <span class="dv">100</span>,</span>
<span id="cb30-4"><a href="#cb30-4"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a>ratest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  glc_rat
t = -1.4485, df = 9, p-value = 0.9093
alternative hypothesis: true mean is greater than 100
95 percent confidence interval:
 76.16687      Inf
sample estimates:
mean of x 
    89.48 </code></pre>
</div>
</div>
</section>
<section id="prueba-t-de-muestras-independientes" class="slide level2">
<h2>Prueba t de muestras independientes</h2>
<div>
<ul>
<li class="fragment"><p>Es usado para comparar las medias aritméticas de dos grupos independientes.</p></li>
<li class="fragment"><p>Por ejemplo, si deseas comparar las medias aritméticas de individuos agrupados por sexo.</p></li>
<li class="fragment"><p>Para ilustrar esta prueba, vamos a hacer uso de la tabla de datos de <code>genderweight</code> del paquete <code>datarium</code>.</p>
<ul>
<li class="fragment">Veamos si existe una diferencia significativa en la media del peso entre hombres y mujeres</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">data</span>(genderweight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prueba-t-de-muestras-independientes-1" class="slide level2 scrollable smaller" data-visibility="uncounted">
<h2>Prueba t de muestras independientes</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Chequeamos normalidad: Group M</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">shapiro.test</span>(<span class="fu">subset</span>(genderweight, group <span class="sc">==</span> <span class="st">"M"</span>)<span class="sc">$</span>weight)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  subset(genderweight, group == "M")$weight
W = 0.98634, p-value = 0.9886</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Chequeamos normalidad: Group F</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">shapiro.test</span>(<span class="fu">subset</span>(genderweight, group <span class="sc">==</span> <span class="st">"F"</span>)<span class="sc">$</span>weight)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  subset(genderweight, group == "F")$weight
W = 0.93847, p-value = 0.2243</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Chequeamos la homogeneidad de las varianzas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">var.test</span>(genderweight<span class="sc">$</span>weight <span class="sc">~</span> genderweight<span class="sc">$</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  genderweight$weight by genderweight$group
F = 0.21692, num df = 19, denom df = 19, p-value = 0.001648
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.08585766 0.54802553
sample estimates:
ratio of variances 
         0.2169152 </code></pre>
</div>
</div>
<div>
<ul>
<li class="fragment"><p><strong>¡La homogeneidad de las varianzas no se cumple!</strong> 😱</p></li>
<li class="fragment"><p>¿Debemos transformar? <span class="fragment">No necesariamente</span></p></li>
<li class="fragment"><p>El no cumplir con el supuesto de la homogeneidad de varianzas no es un gran problema gracias a varias correcciones.</p></li>
<li class="fragment"><p>La función base de R <code>t.test</code> cuenta con el argumento <code>var.equal = F</code> como default.</p></li>
<li class="fragment"><p>Bajo este argumento, no se asumen varianzas iguales entre los grupos y en su lugar R lleva a cabo la aproximación de Welch para lidiar con este problema.</p></li>
</ul>
</div>
</div>
</section>
<section id="prueba-t-de-muestras-independientes-2" class="slide level2" data-visibility="uncounted">
<h2>Prueba t de muestras independientes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>gendertest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(genderweight<span class="sc">$</span>weight <span class="sc">~</span> genderweight<span class="sc">$</span>group)</span>
<span id="cb39-2"><a href="#cb39-2"></a>gendertest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  genderweight$weight by genderweight$group
t = -20.791, df = 26.872, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -24.53135 -20.12353
sample estimates:
mean in group F mean in group M 
       63.49867        85.82612 </code></pre>
</div>
</div>
</section>
<section id="prueba-t-para-muestras-emparejadas" class="slide level2">
<h2>Prueba t para muestras emparejadas</h2>
<div>
<ul>
<li class="fragment"><p>Es usado para comparar las medias de dos grupos que guardan una relación.</p></li>
<li class="fragment"><p>Esto solo ocurre cuando las medidas se han realizado a partir de los mismos grupos. Por ejemplo, al inicio y al final de un experimento.</p></li>
<li class="fragment"><p>Para esta prueba, vamos a usar la tabla de datos <code>crime</code> del paquete <code>UsingR</code></p>
<ul>
<li class="fragment">Veamos si existe una diferencia en las tasas de crimen (# de reportes/100000 habitantes) en 50 estados de los Estados unidos entre 1983 y 1993</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">data</span>(crime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prueba-t-para-muestras-emparejadas-1" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t para muestras emparejadas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>crimetest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1983), <span class="at">y =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1993), <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>crimetest</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983)))</span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1993)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prueba-t-para-muestras-emparejadas-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t para muestras emparejadas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>crimetest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1983), <span class="at">y =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1993), <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>crimetest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  log(crime$y1983) and log(crime$y1993)
t = -10.027, df = 50, p-value = 1.469e-13
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.3628437 -0.2417349
sample estimates:
mean difference 
     -0.3022893 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 362.8298</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1993)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 490.8915</code></pre>
</div>
</div>
</section>
<section id="antes-de-continuar-3" class="slide level2 scrollable">
<h2>Antes de continuar…</h2>
<ul>
<li>Una ayuda a nuestra disposición para interpretar resultados es el paquete <a href="https://easystats.github.io/report/" target="_blank"><code>report</code></a>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">library</span>(report)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">report</span>(ratest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The One Sample t-test testing the difference between glc_rat (mean = 89.48) and
mu = 100 suggests that the effect is negative, statistically not significant,
and small (difference = -10.52, 95% CI [76.17, Inf], t(9) = -1.45, p = 0.909;
Cohen's d = -0.46, 95% CI [-1.00, Inf])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">report</span>(crimetest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The Paired t-test testing the difference between log(crime$y1983) and
log(crime$y1993) (mean difference = -0.30) suggests that the effect is
negative, statistically significant, and large (difference = -0.30, 95% CI
[-0.36, -0.24], t(50) = -10.03, p &lt; .001; Cohen's d = -1.40, 95% CI [-1.79,
-1.01])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">report</span>(gendertest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The Welch Two Sample t-test testing the difference of genderweight$weight by
genderweight$group (mean in group F = 63.50, mean in group M = 85.83) suggests
that the effect is negative, statistically significant, and large (difference =
-22.33, 95% CI [-24.53, -20.12], t(26.87) = -20.79, p &lt; .001; Cohen's d =
-6.57, 95% CI [-8.42, -4.71])</code></pre>
</div>
</div>
</section>
<section id="autoevaluación-1" class="slide level2 smaller">
<h2>Autoevaluación</h2>
<p>En esta autoevaluación, usaremos tablas de datos del paquete <code>UsingR</code> y <code>datarium</code>:</p>
<ol type="1">
<li>La tabla de datos <code>blood</code> (paquete <code>UsingR</code>) tiene las medidas de presión sistólica de sangre correspondientes a 15 pacientes (columna “machine”). De acuerdo al Centro de Prevención y Control de Enfermedades de los Estados Unidos (CDC), una presión sistólica saludable está por debajo de 120 mm Hg. Determina si la media de la muestra contenida en esta tabla de datos está por debajo de este valor sugerido por el CDC.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">data</span>(blood)</span>
<span id="cb55-2"><a href="#cb55-2"></a>blood</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="autoevaluación-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Autoevaluación</h2>
<ol start="2" type="1">
<li>La tabla de datos <code>normtemp</code> (paquete <code>UsingR</code>) tiene las medidas en grados Fahrenheit de temperatura corporal (columna “temperature” ) correspodientes a 65 mujeres y 65 hombres (columna “gender”). Determina si existe una diferencia entre las temperaturas corporales de hombres y mujeres.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">data</span>(normtemp)</span>
<span id="cb56-2"><a href="#cb56-2"></a>normtemp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="autoevaluación-3" class="slide level2 smaller" data-visibility="uncounted">
<h2>Autoevaluación</h2>
<ol start="3" type="1">
<li>La tabla de datos <code>mice2</code> (paquete <code>datarium</code>) tiene las medidas del peso de 10 ratones antes y después de haber sido sometidos a una determinada dieta. Encuentra si existe una diferencia significativa en el peso de estos ratones antes y después del régimen de dieta al que fueron expuestos. ¿Ganaron o perdieron peso?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">data</span>(mice2)</span>
<span id="cb57-2"><a href="#cb57-2"></a>mice2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="autoevaluación-4" class="slide level2 smaller" data-visibility="uncounted">
<h2>Autoevaluación</h2>
<ol start="4" type="1">
<li>En el paquete <code>UsingR</code> tenemos disponible una lista con 5 objetos bajo el nombre <code>cancer</code>. Esta contiene el tiempo de sobreviviencia en días de pacientes con distintos tipos de cáncer desde el momento de su diagnóstico hasta su deceso. Chequea si los datos correspondientes a cáncer de colon son normalmente distribuidos. Si no lo son, prueba si puedes normalizarlos usando alguna de las tres transformaciones que vimos. En el caso que más de una transformación funcione, ¿cuál escogerías para continuar con alguna prueba estadística, y por qué?</li>
</ol>
<p><strong>Tip: usa el siguiente código para extraer en un vector los datos de pacientes con cáncer de colon:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">data</span>(cancer)</span>
<span id="cb58-2"><a href="#cb58-2"></a>colon <span class="ot">&lt;-</span> cancer<span class="sc">$</span>colon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="pruebas-estadísticas-no-paramétricas" class="title-slide slide level1 center">
<h1>Pruebas estadísticas no paramétricas</h1>

</section>
<section id="pruebas-de-wilcoxon-para-datos-no-normales" class="slide level2">
<h2>Pruebas de Wilcoxon para datos no normales</h2>
<div>
<ul>
<li class="fragment"><p>Las pruebas de Wilcoxon usan la mediana como criterio para evaluar la <span class="math inline">\(H_0\)</span>.</p></li>
<li class="fragment"><p>Lastimosamente, estas pruebas son usualmente menos poderosas (mayor tasa de errores tipo II).</p></li>
<li class="fragment"><p>Tiene dos formas:</p>
<ul>
<li class="fragment"><p>Pruebas para una muestra (análoga a la prueba t para una muestra)</p></li>
<li class="fragment"><p>Pruebas para dos muestras (análoga a las pruebas t para dos muestras independientes y emparejadas)</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="prueba-de-wilcoxon-para-una-muestra" class="slide level2">
<h2>Prueba de Wilcoxon para una muestra</h2>
<div>
<ul>
<li class="fragment"><p><a href="https://learningstatisticswithr.com/" target="_blank">Prof.&nbsp;Danielle Navarro</a> midió el nivel de felicidad de sus estudiantes antes y después de su clase de Estadística. Ella estaba interesada en saber si el tomar una clase de Estadística tiene algún efecto en la felicidad de sus estudiantes. Los datos que obtuvo no están normalmente distribuidos. Por ello, se vio en la necesidad de llevar a cabo una prueba de Wilcoxon.</p></li>
<li class="fragment"><p>En este caso, la <span class="math inline">\(H_0\)</span>, es que la diferencia de la mediana de la felicidad de sus estudiantes antes y después de la clase debería ser igual a cero para clamar que no existe tal efecto.</p></li>
</ul>
</div>
</section>
<section id="prueba-de-wilcoxon-para-una-muestra-1" class="slide level2" data-visibility="uncounted">
<h2>Prueba de Wilcoxon para una muestra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Primero recreo la tabla de Prof. Navarro</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>felicidad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">before =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">43</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">23</span>,<span class="dv">40</span>,<span class="dv">29</span>,<span class="dv">56</span>,<span class="dv">38</span>,<span class="dv">16</span>),</span>
<span id="cb59-3"><a href="#cb59-3"></a>                        <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">11</span>,<span class="dv">31</span>,<span class="dv">17</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">21</span>,<span class="dv">8</span>,<span class="dv">21</span>))</span>
<span id="cb59-4"><a href="#cb59-4"></a>felicidad<span class="sc">$</span>change <span class="ot">&lt;-</span> felicidad<span class="sc">$</span>after <span class="sc">-</span> felicidad<span class="sc">$</span>before</span>
<span id="cb59-5"><a href="#cb59-5"></a></span>
<span id="cb59-6"><a href="#cb59-6"></a>muestra_wilcox <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(felicidad<span class="sc">$</span>change, <span class="at">mu =</span> <span class="dv">0</span>)</span>
<span id="cb59-7"><a href="#cb59-7"></a><span class="fu">report</span>(muestra_wilcox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Funder's (2019) recommendations.

The Wilcoxon signed rank exact test testing the difference in rank for
felicidad$change and true location of 0 suggests that the effect is negative,
statistically significant, and very large (W = 7.00, p = 0.037; r (rank
biserial) = -0.75, 95% CI [-0.93, -0.26])</code></pre>
</div>
</div>
</section>
<section id="prueba-de-wilcoxon-para-dos-muestras" class="slide level2">
<h2>Prueba de Wilcoxon para dos muestras</h2>
<div>
<ul>
<li class="fragment"><p>Regresando al ejemplo de la tabla de datos <code>genderweight</code>, supongamos que estos no están normalmente distribuidos.</p></li>
<li class="fragment"><p>Usaremos la prueba de Wilcoxon para muestras independientes para ver si existe diferencia entre los pesos de hombres y mujeres.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>dos_wilcox <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(genderweight<span class="sc">$</span>weight <span class="sc">~</span> genderweight<span class="sc">$</span>group, <span class="at">paired =</span> F)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">report</span>(dos_wilcox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Funder's (2019) recommendations.

The Wilcoxon rank sum exact test testing the difference in ranks between
genderweight$weight and genderweight$group suggests that the effect is
negative, statistically significant, and very large (W = 0.00, p &lt; .001; r
(rank biserial) = -1.00, 95% CI [-1.00, -1.00])</code></pre>
</div>
</div>
</div>
</section>
<section id="autoevaluación-5" class="slide level2">
<h2>Autoevaluación</h2>
<ol type="1">
<li><p>Con el vector de nombre <code>colon</code> que creaste en la anterior autoevaluación, aplica una prueba de Wilcoxon para una muestra bajo la hipótesis de que la mediana de los días de superviviencia de un paciente con cáncer de colon es de 370 días.</p></li>
<li><p>A partir de la tabla de datos de felicidad de la Prof.&nbsp;Navarro, lleva a cabo una prueba de Wilcoxon para dos muestras emparejadas de la felicidad de los estudiantes antes y después de recibir una clase de Estadística. Compara el resultado con la prueba de una muestra que usé de ejemplo. ¿Por qué no hay diferencia?.</p></li>
</ol>
</section></section>
<section>
<section id="análisis-de-varianza-anova" class="title-slide slide level1 center">
<h1>Análisis de Varianza (ANOVA)</h1>

</section>
<section id="introducción" class="slide level2">
<h2>Introducción</h2>
<div>
<ul>
<li class="fragment"><p>Hasta el momento nos hemos enfocado a los casos donde comparamos las medias entre dos grupos.</p></li>
<li class="fragment"><p>Pero es más común el evaluar distintos tratamientos al mismo tiempo.</p></li>
<li class="fragment"><p>Para ello, contamos con el ANOVA, desarrollado por el estadístico Ronald Fisher a inicios del siglo 20, y que sin duda es el método estadístico más usado hoy en día.</p></li>
<li class="fragment"><p>El objetivo de un ANOVA es el de determinar la existencia de diferencias entre las medias aritméticas de las muestras representativas de <span class="math inline">\(n\)</span> poblaciones (o en términos más precisos, tratamientos).</p></li>
</ul>
</div>
</section>
<section id="supuestos-del-anova" class="slide level2 smaller">
<h2>Supuestos del ANOVA</h2>
<div>
<ol type="1">
<li class="fragment"><p>Independencia de los datos: correcta randomización en el diseño del experimento.</p></li>
<li class="fragment"><p>Homogeneidad de las varianzas: la varianza entre los tratamientos es la misma.</p></li>
<li class="fragment"><p><strong>Normalidad</strong>: <span class="fragment">pero, ¿de qué exactamente?</span></p></li>
</ol>
<ul>
<li class="fragment"><p>Cómo vimos antes, la normalidad es un requisito para conducir pruebas t, y lo es también para el ANOVA.</p></li>
<li class="fragment"><p>Muchos libros de texto y otros recursos, mencionan que los datos de cada tratamiento deben ser normalmente distribuidos para llevar a cabo un ANOVA. <span class="fragment">Esto es cierto e impráctico a la vez.</span></p></li>
<li class="fragment"><p>Mencionamos que como mínimo deberíamos contar con 3 repeticiones por tratamiento. <span class="fragment">Pero, ¿son 3 repeticiones suficientes para alcanzar la normalidad?</span></p></li>
<li class="fragment"><p>Es común el sugerir el llevar a cabo una prueba de normalidad antes de un ANOVA, pero debemos considerar que:</p>
<ul>
<li class="fragment"><p>Cada tratamiento tiene su propia media, en caso de medias muy distantes entre sí, la prueba puede fallar.</p></li>
<li class="fragment"><p>En su lugar, podrías correr una prueba por cada tratamiento. Esto solo funciona con un considerable número de observaciones/tratamiento (3 no son suficientes).</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="supuestos-del-anova-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Supuestos del ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>Esto nos puede llevar a soluciones erróneas como transformar datos, borrar outliers o utilizar pruebas no paramétricas innecesariamente.</p></li>
<li class="fragment"><p>Entonces, ¿<strong>normalidad</strong> de qué?</p></li>
<li class="fragment"><p>De los residuos estandarizados!… <span class="fragment">¿Qué es un residual?</span></p>
<ul>
<li class="fragment"><p>Un residual es la diferencia entre una observación y su predicción</p></li>
<li class="fragment"><p>Un residual estandarizado resulta de la división del residual para la raíz cuadrada de la predicción</p></li>
<li class="fragment"><p>La distribución muestral de los residuos estandarizados tiene media 0 y desviación estándar 1</p></li>
</ul></li>
<li class="fragment"><p>Y es sobre esta distribución que los valores críticos del ANOVA (valores F) son calculados. Es decir, estos no dependen enteramente de los datos originales, por lo tanto los datos originales no tienen que ser necesariamente normalmente distribuidos.</p></li>
<li class="fragment"><p>Pero, ¿por qué la confusión? <span class="fragment">Solo cuando el número de observaciones es lo suficientemente grande, se tiene la certeza que los residuos serán normalmente distribuidos.</span></p></li>
<li class="fragment"><p>En resumen, es mejor chequear la normalidad después que realizamos el ANOVA.</p></li>
</ul>
</div>
</section>
<section id="el-dataset-de-recursos-por-depredación" class="slide level2">
<h2>El dataset de recursos por depredación</h2>

<img data-src="images/frog.jpg" class="r-stretch quarto-figure-center"><div class="footer">
<p>Imagen tomada por <a href="https://pixabay.com/users/12019-12019/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=69813" target="_blank">David Mark</a> de <a href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=69813" target="_blank">Pixabay</a></p>
</div>
</section>
<section id="el-dataset-de-recursos-por-depredación-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>El dataset de recursos por depredación</h2>
<div>
<ul>
<li class="fragment"><p>Los datos que usaremos en esta y otras secciones corresponden a un experimento del <a href="https://www.jstor.org/stable/23436298" target="_blank">Prof.&nbsp;Justin C. Touchon</a> acerca de la interacción entre predadores y recursos.</p></li>
<li class="fragment"><p>El experimento consistió de múltiples tanques (mesocosmos) dispuestos al aire libre en Gamboa, Panamá. Los investigadores tenían por objetivo el saber como la variación en la incubación de huevos de la rana arbórea de ojos rojos podría afectar su desarrollo hasta la metamorfosis bajo varias combinaciones de recursos y predadores.</p></li>
<li class="fragment"><p>Los tratamientos fueron los siguientes:</p>
<ul>
<li class="fragment"><p>Edad de incubación: Temprana (<code>E</code>: 4 días después de la oviposición) o tardía (<code>L</code>: 6 días después de la oviposición).</p></li>
<li class="fragment"><p>Predadores: control (<code>C</code>), no letal (<code>NL</code>: larvas de libélula enjauladas) y letal (<code>L</code>: larvas de libélula libres)</p></li>
<li class="fragment"><p>Recursos: bajo (<code>Lo</code>: 0.75 g) o alto (<code>Hi</code>: 1.5 g) de comida suministrados cada 5 días.</p></li>
</ul></li>
<li class="fragment"><p>Los mesocosmos fueron colocados en 8 bloques de 12 tanques cada uno.</p></li>
<li class="fragment"><p>El experimento inició con 50 renacuajos por tanque y terminó cuando todos los renacuajos alcanzaron la metamorfosis, o murieron.</p></li>
</ul>
</div>
</section>
<section id="el-dataset-de-recursos-por-depredación-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>El dataset de recursos por depredación</h2>
<div>
<ul>
<li class="fragment"><p>Variables de respuesta:</p>
<ul>
<li class="fragment"><p>Edad de metaformosis contada desde el día de oviposición (<code>Age.DPO</code>).</p></li>
<li class="fragment"><p>Edad de salida del agua (<code>Age.FromEmergence</code>)</p></li>
<li class="fragment"><p>Longitud nariz-cloaca al emerger (<code>SVL.initial</code>)</p></li>
<li class="fragment"><p>Longitud de la cola al emerger (<code>Tail.initial</code>)</p></li>
<li class="fragment"><p>Longitud nariz-cloaca al término de la reabsorción de la cola (<code>SVL.final</code>)</p></li>
<li class="fragment"><p>Peso al término de la reabsorción de la cola (<code>Mass.final</code>)</p></li>
<li class="fragment"><p>Número de días requeridos por cada metamorfo para reabsorber completamente la cola (<code>Resorb.days</code>)</p></li>
</ul></li>
<li class="fragment"><p>18 tanques conteniendo predadores no letales fueron descartados debido al brote de una enfermedad</p></li>
<li class="fragment"><p><strong>NOTA:</strong> el dataset original de Touchon contiene alrededor de 2500 observaciones. Sin embargo, para poder usar los datos bajo los supuestos del ANOVA es necesario reducirlos a las medias aritméticas de cada tratamiento por cuanto se tratan de pseudo repeticiones. Esta reducción ya está hecha en el archivo “touchon.csv” disponible con el <a href="https://mmorenozam.github.io/see-quarto-website/materiales.html" target="_blank">resto de materiales extras del curso.</a></p></li>
</ul>
</div>
</section>
<section id="explorando-este-dataset" class="slide level2">
<h2>Explorando este dataset</h2>
<div>
<ul>
<li class="fragment"><p>Haremos una exploración básica del dataset anteriormente descrito: gráficos de caja y bigote, de barras, de densidad y matrices de dispersión.</p></li>
<li class="fragment"><p>Como estos datos han sido pre-procesados, omitiremos el mapa de observaciones perdidas.</p></li>
<li class="fragment"><p>Para esto, aprovecho la oportunidad para introducir otro par de paquetes útiles</p></li>
<li class="fragment"><p>Como vimos anteriormente, <code>ggplot2</code> es una poderosa librería de visualización de datos cuyo uso es relativamente sencillo. Sin embargo, su dominio requiere un poco de tiempo y paciencia. Para quienes quizá deseen una manera más rápida de realizar sus gráficos y solamente tomarse el tiempo en añadir detalles finales, usaremos <code>ggpubr</code>.</p></li>
</ul>
</div>
</section>
<section id="medias-aritméticas-observadas" class="slide level2">
<h2>Medias aritméticas observadas</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># usaremos nuevamente el paquete `tidycomm` para los estadísticos descriptivos</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="fu">describe</span>(ranas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ranas 

 12  Variables      78  Observations
--------------------------------------------------------------------------------
Block 
       n  missing distinct     Info     Mean      Gmd 
      78        0        8    0.983    4.128    2.645 
                                                          
Value          1     2     3     4     5     6     7     8
Frequency     12    12    12     8    10     8     8     8
Proportion 0.154 0.154 0.154 0.103 0.128 0.103 0.103 0.103

For the frequency table, variable is rounded to the nearest 0
--------------------------------------------------------------------------------
Tank.Unique 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       78        1    44.24    32.46     4.85     8.70 
     .25      .50      .75      .90      .95 
   20.25    40.50    67.50    84.60    90.15 

lowest :  1  2  3  4  5, highest: 90 91 92 94 96
--------------------------------------------------------------------------------
Pred 
       n  missing distinct 
      78        0        3 
                            
Value          C     L    NL
Frequency     32    32    14
Proportion 0.410 0.410 0.179
--------------------------------------------------------------------------------
Hatch 
       n  missing distinct 
      78        0        2 
                  
Value        E   L
Frequency   39  39
Proportion 0.5 0.5
--------------------------------------------------------------------------------
Res 
       n  missing distinct 
      78        0        2 
                  
Value       Hi  Lo
Frequency   39  39
Proportion 0.5 0.5
--------------------------------------------------------------------------------
Age.DPO 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       77        1    64.69    24.47    43.24    45.12 
     .25      .50      .75      .90      .95 
   47.74    57.44    71.68   101.03   114.37 

lowest : 38.1111 40.6341 41.8333 42.65   43.3478
highest: 114.114 115.81  128.225 135.121 140.902
--------------------------------------------------------------------------------
Age.FromEmergence 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       77        1    30.69    24.47    9.243   11.125 
     .25      .50      .75      .90      .95 
  13.738   23.439   37.682   67.031   80.368 

lowest : 4.11111 6.63415 7.83333 8.65    9.34783
highest: 80.1136 81.8095 94.225  101.121 106.902
--------------------------------------------------------------------------------
SVL.initial 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       78        1       19    1.484    17.37    17.68 
     .25      .50      .75      .90      .95 
   18.03    18.94    19.68    21.34    21.73 

lowest : 16.3205 16.6179 16.8889 17.315  17.3838
highest: 21.725  21.76   21.9167 22.125  22.3   
--------------------------------------------------------------------------------
Tail.initial 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       78        1    5.867   0.9237    4.777    4.901 
     .25      .50      .75      .90      .95 
   5.330    5.680    6.163    7.004    7.502 

lowest : 4.41111 4.55854 4.58    4.63462 4.80222
highest: 7.45833 7.75    7.8     7.8375  8.6    
--------------------------------------------------------------------------------
SVL.final 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       78        1    19.38    1.576    17.71    17.90 
     .25      .50      .75      .90      .95 
   18.29    19.23    20.02    21.74    22.14 

lowest : 16.6818 17.0222 17.0769 17.5425 17.7432
highest: 22.1    22.4    22.6    23.2    23.3   
--------------------------------------------------------------------------------
Mass.final 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       78        1   0.4301   0.1124   0.3239   0.3323 
     .25      .50      .75      .90      .95 
  0.3592   0.4043   0.4618   0.6235   0.6994 

lowest : 0.269318 0.281026 0.293333 0.315135 0.325455
highest: 0.6975   0.71     0.712    0.7375   0.75    
--------------------------------------------------------------------------------
Resorb.days 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
      78        0       73        1      4.4    0.659    3.632    3.764 
     .25      .50      .75      .90      .95 
   4.024    4.255    4.789    5.116    5.546 

lowest : 3.375   3.44444 3.48936 3.51111 3.65385
highest: 5.30303 5.53659 5.6     5.75    6.5    
--------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="gráficos-de-barras" class="slide level2 scrollable">
<h2>Gráficos de barras</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Código</a></li><li><a href="#tabset-1-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="fu">ggbarplot</span>(<span class="at">data =</span> ranas,</span>
<span id="cb65-3"><a href="#cb65-3"></a>          <span class="at">x =</span> <span class="st">"Pred"</span>,</span>
<span id="cb65-4"><a href="#cb65-4"></a>          <span class="at">y =</span> <span class="st">"Age.FromEmergence"</span>,</span>
<span id="cb65-5"><a href="#cb65-5"></a>          <span class="at">add =</span> <span class="st">"mean_se"</span>,</span>
<span id="cb65-6"><a href="#cb65-6"></a>          <span class="at">fill =</span> <span class="st">"Pred"</span>)</span>
<span id="cb65-7"><a href="#cb65-7"></a></span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="fu">ggbarplot</span>(<span class="at">data =</span> ranas,</span>
<span id="cb65-9"><a href="#cb65-9"></a>          <span class="at">x =</span> <span class="st">"Res"</span>,</span>
<span id="cb65-10"><a href="#cb65-10"></a>          <span class="at">y =</span> <span class="st">"Age.FromEmergence"</span>,</span>
<span id="cb65-11"><a href="#cb65-11"></a>          <span class="at">add =</span> <span class="st">"mean_se"</span>,</span>
<span id="cb65-12"><a href="#cb65-12"></a>          <span class="at">fill =</span> <span class="st">"Pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-39-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-39-2.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gráficos-de-barras-1" class="slide level2 scrollable" data-visibility="uncounted">
<h2>Gráficos de barras</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Código</a></li><li><a href="#tabset-2-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggbarplot</span>(<span class="at">data =</span> ranas,</span>
<span id="cb66-2"><a href="#cb66-2"></a>                <span class="at">x =</span> <span class="st">"Pred"</span>,</span>
<span id="cb66-3"><a href="#cb66-3"></a>                <span class="at">y =</span> <span class="st">"Age.FromEmergence"</span>,</span>
<span id="cb66-4"><a href="#cb66-4"></a>                <span class="at">add =</span> <span class="st">"mean_se"</span>,</span>
<span id="cb66-5"><a href="#cb66-5"></a>                <span class="at">fill =</span> <span class="st">"Pred"</span>)</span>
<span id="cb66-6"><a href="#cb66-6"></a></span>
<span id="cb66-7"><a href="#cb66-7"></a>p1 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Gráfico de barras de edad desde oviposición"</span>,</span>
<span id="cb66-8"><a href="#cb66-8"></a>       <span class="at">subtitle =</span> <span class="st">"Datos del estudio de Prof. Touchon"</span>,</span>
<span id="cb66-9"><a href="#cb66-9"></a>       <span class="at">caption =</span> <span class="st">"Gráfica propia"</span>,</span>
<span id="cb66-10"><a href="#cb66-10"></a>       <span class="at">x =</span> <span class="st">"Predadores"</span>,</span>
<span id="cb66-11"><a href="#cb66-11"></a>       <span class="at">y =</span> <span class="st">"Edad desde oviposición"</span>,</span>
<span id="cb66-12"><a href="#cb66-12"></a>       <span class="at">color =</span> <span class="st">"Predador"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-41-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gráficos-de-caja-y-bigote" class="slide level2 scrollable">
<h2>Gráficos de caja y bigote</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Código</a></li><li><a href="#tabset-3-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">ggboxplot</span>(<span class="at">data =</span> ranas,</span>
<span id="cb67-2"><a href="#cb67-2"></a>          <span class="at">x =</span> <span class="st">"Pred"</span>,</span>
<span id="cb67-3"><a href="#cb67-3"></a>          <span class="at">y =</span> <span class="st">"Age.FromEmergence"</span>,</span>
<span id="cb67-4"><a href="#cb67-4"></a>          <span class="at">fill =</span> <span class="st">"Pred"</span>)</span>
<span id="cb67-5"><a href="#cb67-5"></a></span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="fu">ggboxplot</span>(<span class="at">data =</span> ranas,</span>
<span id="cb67-7"><a href="#cb67-7"></a>          <span class="at">x =</span> <span class="st">"Res"</span>,</span>
<span id="cb67-8"><a href="#cb67-8"></a>          <span class="at">y =</span> <span class="st">"Age.FromEmergence"</span>,</span>
<span id="cb67-9"><a href="#cb67-9"></a>          <span class="at">fill =</span> <span class="st">"Res"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-43-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-43-2.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gráficos-de-densidad" class="slide level2 scrollable">
<h2>Gráficos de densidad</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Código</a></li><li><a href="#tabset-4-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">ggdensity</span>(<span class="at">data =</span> ranas,</span>
<span id="cb68-2"><a href="#cb68-2"></a>          <span class="at">x =</span> <span class="st">"Age.FromEmergence"</span>, </span>
<span id="cb68-3"><a href="#cb68-3"></a>          <span class="at">add =</span> <span class="st">"mean"</span>, </span>
<span id="cb68-4"><a href="#cb68-4"></a>          <span class="at">rug =</span> <span class="st">"true"</span>, </span>
<span id="cb68-5"><a href="#cb68-5"></a>          <span class="at">color =</span> <span class="st">"Pred"</span>, </span>
<span id="cb68-6"><a href="#cb68-6"></a>          <span class="at">fill =</span> <span class="st">"Pred"</span>)</span>
<span id="cb68-7"><a href="#cb68-7"></a></span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="fu">ggdensity</span>(<span class="at">data =</span> ranas,</span>
<span id="cb68-9"><a href="#cb68-9"></a>          <span class="at">x =</span> <span class="st">"Age.FromEmergence"</span>, </span>
<span id="cb68-10"><a href="#cb68-10"></a>          <span class="at">add =</span> <span class="st">"mean"</span>, </span>
<span id="cb68-11"><a href="#cb68-11"></a>          <span class="at">rug =</span> <span class="st">"true"</span>, </span>
<span id="cb68-12"><a href="#cb68-12"></a>          <span class="at">color =</span> <span class="st">"Res"</span>, </span>
<span id="cb68-13"><a href="#cb68-13"></a>          <span class="at">fill =</span> <span class="st">"Res"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-45-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-45-2.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="matriz-de-dispersión" class="slide level2 scrollable">
<h2>Matriz de dispersión</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Código</a></li><li><a href="#tabset-5-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb69-2"><a href="#cb69-2"></a>ranas_matriz <span class="ot">&lt;-</span> ranas[,<span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">12</span>)]</span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="fu">ggpairs</span>(ranas_matriz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-47-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="anova-de-una-vía" class="slide level2 smaller">
<h2>ANOVA de una vía</h2>
<div>
<ul>
<li class="fragment"><p>ANOVA de una vía se refiere cuando tenemos más de dos tratamientos que están definidos por un solo factor a la vez.</p></li>
<li class="fragment"><p>Usando los datos del Prof.&nbsp;Touchon, vamos a ilustrar el caso del ANOVA de una vía. Para ello, vamos a considerar lo siguiente</p>
<ul>
<li class="fragment"><p>Supongamos que estamos interesados en saber si existe alguna diferencia entre la edad de salida del agua <code>Age.FromEmergence</code> determinada por los predadores:</p></li>
<li class="fragment"><p>Los niveles del factor predadores son:</p>
<ul>
<li class="fragment"><p>Predadores no letales <code>NL</code></p></li>
<li class="fragment"><p>Predadores letales <code>L</code></p></li>
<li class="fragment"><p>Control (sin predadores) <code>C</code></p></li>
</ul></li>
</ul></li>
<li class="fragment"><p>La <span class="math inline">\(H_0\)</span> en todo ANOVA es simplemente que no existe diferencia entre <span class="math inline">\(n\)</span> tratamientos, y la <span class="math inline">\(H_a\)</span> es que al menos uno de los tratamientos tiene una media distinta.</p></li>
</ul>
</div>
</section>
<section id="anova-en-r" class="slide level2">
<h2>ANOVA en R</h2>
<div>
<ul>
<li class="fragment"><p>Existen dos formas de llevar a cabo ANOVA en R:</p>
<ol type="1">
<li class="fragment"><p>Crear un modelo lineal con la función <code>lm</code> y luego el ANOVA con la función <code>anova</code> sobre el objeto producto de <code>lm</code>.</p></li>
<li class="fragment"><p>Aplicar directamente la función <code>aov</code> sobre nuestros datos.</p></li>
</ol></li>
<li class="fragment"><p>Ambas funciones (<code>lm</code> y <code>aov</code>) tienen la misma sintaxis. <span class="fragment">La primera opción es la más usada.</span></p></li>
<li class="fragment"><p>Adicionalmente, el paquete <code>car</code> ofrece la función <code>Anova</code>. El resultado de ambas es prácticamente el mismo para la mayoría de modelos. <span class="fragment">La ventaja de esta última yace en que <code>Anova</code> puede realizar cálculos de los valores críticos usando sumas de cuadrados de tipo I, II y III.</span></p></li>
</ul>
</div>
</section>
<section id="anova-de-una-vía-en-r" class="slide level2">
<h2>ANOVA de una vía en R</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Opción 1</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">library</span>(car)</span>
<span id="cb70-2"><a href="#cb70-2"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="fu">Anova</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Opción 2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>anova1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="fu">summary</span>(anova1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Age.FromEmergence
          Sum Sq Df F value    Pr(&gt;F)    
Pred        9467  2  10.442 9.986e-05 ***
Residuals  33999 75                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Pred         2   9467    4733   10.44 9.99e-05 ***
Residuals   75  33999     453                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="anova-de-una-vía-en-r-1" class="slide level2" data-visibility="uncounted">
<h2>ANOVA de una vía en R</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Opción 1</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">library</span>(car)</span>
<span id="cb74-2"><a href="#cb74-2"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="fu">report</span>(<span class="fu">Anova</span>(lm1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Opción 2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>anova1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="fu">report</span>(anova1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA suggests that:

  - The main effect of Pred is statistically significant and large (F(2, 75) =
10.44, p &lt; .001; Eta2 = 0.22, 95% CI [0.09, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA (formula: Age.FromEmergence ~ Pred) suggests that:

  - The main effect of Pred is statistically significant and large (F(2, 75) =
10.44, p &lt; .001; Eta2 = 0.22, 95% CI [0.09, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="diagnósticos-del-anova" class="slide level2">
<h2>Diagnósticos del ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>Antes de conducir pruebas formales para los supuestos del ANOVA, es preciso darle un vistazo a diagnósticos visuales que podemos obtener del mismo.</p></li>
<li class="fragment"><p>El ANOVA es un caso de regresión lineal (con predictores categóricos), por lo que en esta sección nos centraremos en la interpretación de estos diagnósticos desde la perspectiva del ANOVA.</p></li>
<li class="fragment"><p>En el apartado de regresión lineal volveremos a profundizar en las interpretaciones de los mismos para ese caso determinado.</p></li>
<li class="fragment"><p>Para acceder a estos diagnósticos, basta usar la función <code>plot</code> sobre el objeto donde guardamos los resultados del modelo <code>lm1</code>.</p></li>
</ul>
</div>
</section>
<section id="diagnósticos-del-anova-1" class="slide level2" data-visibility="uncounted">
<h2>Diagnósticos del ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="fu">plot</span>(lm1)</span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnósticos-del-anova-2" class="slide level2" data-visibility="uncounted">
<h2>Diagnósticos del ANOVA</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-57-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="diagnósticos-del-anova-3" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos del ANOVA</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-58-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Residuos vs.&nbsp;Valores ajustados</strong></p>
<p>En este plot podemos evidenciar departuras del supuesto de la homocedasticidad. Idealmente, la línea roja que se muestra debería ir a lo largo de la horizontal en la coordenada cero del eje y (sobre la línea entrecortada).</p>
</div>
</div>
</section>
<section id="diagnósticos-del-anova-4" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos del ANOVA</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-59-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Gráfico Q-Q</strong></p>
<p>A diferencia del gráfico Q-Q que vimos para las pruebas t, en el eje y de este mismo gráfico para el ANOVA (y regresión lineal) se representan los residuos estandarizados. La interpretación es la misma: idealmente los puntos deberían ir a lo largo de la diagonal. Cuando no es así, evidencia una violación del supuesto de la normalidad.</p>
</div>
</div>
</section>
<section id="diagnósticos-del-anova-5" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos del ANOVA</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-60-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Raíz cuadrada de los residuos estandarizados vs.&nbsp;Valores ajustados</strong></p>
<p>Similar al primer diagnóstico, en el caso del ANOVA, nos da una idea de posibles departuras de la homogeneidad de las varianzas. La línea roja idealmente debería ser completamente horizontal.</p>
</div>
</div>
</section>
<section id="diagnósticos-del-anova-6" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos del ANOVA</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-61-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Residuos vs.&nbsp;Apalancamiento</strong></p>
<p>Aquellos puntos que estén etiquetados con números son mostrados como posibles outliers bajo dos criterios:</p>
<ul>
<li><p>Están por fuera de los límites de la regla del rango intercuartílico (IQR), y</p></li>
<li><p>Marcados como outliers con influencia de apalancamiento mediante la prueba de Cook (distancia de Cook).</p></li>
</ul>
<p>El segundo criterio es un argumento sólido para remover outliers.</p>
</div>
</div>
</section>
<section id="transformaciones" class="slide level2">
<h2>Transformaciones</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.FromEmergence) <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="fu">plot</span>(lm2)</span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transformaciones-1" class="slide level2" data-visibility="uncounted">
<h2>Transformaciones</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-63-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="prueba-formal-de-normalidad" class="slide level2">
<h2>Prueba formal de normalidad</h2>
<div>
<ul>
<li class="fragment"><p>Como vimos, después de aplicar la transformación logarítmica el gráfico Q-Q mejoró considerablemente.</p></li>
<li class="fragment"><p>Para estar seguros, podemos correr un test formal sobre los residuos del modelo con la ayuda del paquete <code>olsrr</code> mediante su función <code>ols_test_normality</code>.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="fu">ols_test_normality</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.9802         0.2645 
Kolmogorov-Smirnov        0.0893         0.5625 
Cramer-von Mises          8.6738         0.0000 
Anderson-Darling          0.5447         0.1566 
-----------------------------------------------</code></pre>
</div>
</div>
</div>
</section>
<section id="prueba-formal-de-normalidad-1" class="slide level2" data-visibility="uncounted">
<h2>Prueba formal de normalidad</h2>
<div>
<ul>
<li class="fragment">O también podemos calcular la prueba de Shapiro-Wilk con funciones base de R</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>residuos <span class="ot">&lt;-</span> <span class="fu">resid</span>(lm2)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="fu">shapiro.test</span>(residuos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuos
W = 0.98017, p-value = 0.2645</code></pre>
</div>
</div>
</div>
</section>
<section id="homogeneidad-de-las-varianzas-en-anova" class="slide level2">
<h2>Homogeneidad de las varianzas en ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>La prueba más usada para chequear la homogeneidad de varianzas de un ANOVA es la de Levene.</p></li>
<li class="fragment"><p>Para ello utilizaremos la función <code>leveneTest</code> del paquete <code>car</code>. Podemos usar esta función directamente sobre los datos con la misma sintaxis de <code>lm</code>, o sobre el objeto <code>lm2</code> en el que anteriormente almacenamos el resultado del modelo lineal con la transformación.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">leveneTest</span>(lm2, <span class="at">center =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "mean")
      Df F value  Pr(&gt;F)  
group  2  3.0464 0.05345 .
      75                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</section>
<section id="anova-de-una-vía-en-r-continuación" class="slide level2">
<h2>ANOVA de una vía en R (continuación)</h2>
<div>
<ul>
<li class="fragment">Así, una vez que hemos transformado para obtener normalidad en los residuos y chequeado la homogeneidad de varianzas, es tiempo de hecharle un vistazo al resultado del ANOVA:</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">library</span>(modelsumm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(modelsumm): there is no package called 'modelsumm'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">Anova</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: log(Age.FromEmergence)
          Sum Sq Df F value    Pr(&gt;F)    
Pred       9.710  2  12.389 2.244e-05 ***
Residuals 29.392 75                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Por tanto, podemos concluir que al menos uno de los tratamientos es distinto (aceptamos la <span class="math inline">\(H_a\)</span> y rechazamos la <span class="math inline">\(H_0\)</span>)</li>
</ul>
</div>
</section>
<section id="qué-tan-distintos" class="slide level2 smaller">
<h2>¿Qué tan distintos?</h2>
<div>
<ul>
<li class="fragment"><p>Preguntas naturales seguidas de estos resultados son: ¿qué tan distintos son los tratamientos entre sí?, ¿puedo acaso ordernarlos de mayor a menor?, ¿existen pares de tratamientos que son iguales?</p></li>
<li class="fragment"><p>Podemos comenzar con una ayuda visual (ligeramente distinto a nuestro AED, usando la transformación logarítmica)</p></li>
</ul>
</div>
<div class="fragment">
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Código</a></li><li><a href="#tabset-6-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="co"># usamos ggpubr nuevamente</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>ranas<span class="sc">$</span>log.Age.FromEmergence <span class="ot">&lt;-</span> <span class="fu">log</span>(ranas<span class="sc">$</span>Age.FromEmergence)</span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="fu">ggboxplot</span>(ranas,</span>
<span id="cb90-4"><a href="#cb90-4"></a>          <span class="at">x =</span> <span class="st">"Pred"</span>,</span>
<span id="cb90-5"><a href="#cb90-5"></a>          <span class="at">y =</span> <span class="st">"log.Age.FromEmergence"</span>,</span>
<span id="cb90-6"><a href="#cb90-6"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb90-7"><a href="#cb90-7"></a>          <span class="at">color =</span> <span class="st">"Pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-69-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparaciones-múltiples" class="slide level2 smaller">
<h2>Comparaciones múltiples</h2>
<div>
<ul>
<li class="fragment"><p>Los métodos de comparaciones múltiples y gráficos de interacción nos ayudan a responder estas preguntas.</p></li>
<li class="fragment"><p>En el caso de los gráficos de interacción para ANOVA de una vía, no tiene mucho sentido llevarlos a cabo ya que son más útiles para ANOVA de múltiples vías, así que los dejaremos para después.</p></li>
<li class="fragment"><p>Las comparaciones múltiples más usadas son:</p>
<ul>
<li class="fragment"><p>HSD Tukey (<em>Honestly significant difference</em>): lleva a cabo todos los pares de comparaciones posibles entre los niveles de un factor.</p></li>
<li class="fragment"><p>Prueba de Dunnett: Compara los niveles únicamente con respecto al nivel control dentro del factor.</p></li>
</ul></li>
<li class="fragment"><p>Son conocidas también como pruebas <em>post-hoc</em>.</p></li>
<li class="fragment"><p>En R, una manera de realizar comparaciones múltiples es mediante los paquetes <code>emmeans</code> y <code>multcomp</code> (este último depende de <code>multcompView</code>, así que no olvides instalarlo también).</p></li>
</ul>
</div>
</section>
<section id="hsd-tukey" class="slide level2 smaller">
<h2>HSD Tukey</h2>
<div class="fragment">
<p>Calculamos las medias marginales a partir del modelo</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb91-2"><a href="#cb91-2"></a>ph1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm2, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-3"><a href="#cb91-3"></a><span class="fu">summary</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="hsd-tukey-1" class="slide level2 smaller" data-autoanimate="true">
<h2>HSD Tukey</h2>
<p>Calculamos las medias marginales a partir del modelo</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb92-2"><a href="#cb92-2"></a>ph1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm2, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="fu">summary</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Pred response   SE df lower.CL upper.CL
 C        34.2 3.79 75     27.4     42.6
 L        15.8 1.75 75     12.7     19.7
 NL       26.2 4.38 75     18.8     36.5

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="fu">report</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Oops, objects of class [emmGrid] are not supported (yet) by report() :(

Want to help? Check out https://easystats.github.io/report/articles/new_models.html</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Ahora podemos calcular las comparaciones por pares de HSD Tukey</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>tukey_comp <span class="ot">&lt;-</span> <span class="fu">contrast</span>(ph1, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>)</span>
<span id="cb96-2"><a href="#cb96-2"></a>tukey_comp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast ratio    SE df null t.ratio p.value
 C / L    2.165 0.339 75    1   4.936  &lt;.0001
 C / NL   1.307 0.262 75    1   1.335  0.3806
 L / NL   0.604 0.121 75    1  -2.516  0.0368

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
</section>
<section id="prueba-de-dunnett" class="slide level2 smaller scrollable">
<h2>Prueba de Dunnett</h2>
<div class="fragment">
<ul>
<li>Para Dunnett, es importante el establecer el grupo control</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>dunnett_comp <span class="ot">&lt;-</span> <span class="fu">contrast</span>(ph1, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">method =</span> <span class="st">"dunnett"</span>, <span class="at">ref =</span> <span class="st">"C"</span>)</span>
<span id="cb98-2"><a href="#cb98-2"></a>dunnett_comp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast ratio     SE df null t.ratio p.value
 L / C    0.462 0.0723 75    1  -4.936  &lt;.0001
 NL / C   0.765 0.1535 75    1  -1.335  0.3177

P value adjustment: dunnettx method for 2 tests 
Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Finalmente, otra tabla de resumen de las comparaciones múltiples es la de agrupar las medias aritméticas marginales con números (o letras) de acuerdo a si estas son estadísticamente distintas o no entre si. Para ello podemos usar el paquete <code>multcomp</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co"># multcomp necesita un paquete extra llamada multcompView</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="co"># No olvides instalar multcompView antes de correr este código</span></span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb100-4"><a href="#cb100-4"></a>medias_marginales <span class="ot">&lt;-</span> <span class="fu">cld</span>(ph1)</span>
<span id="cb100-5"><a href="#cb100-5"></a>medias_marginales</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Pred response   SE df lower.CL upper.CL .group
 L        15.8 1.75 75     12.7     19.7  1    
 NL       26.2 4.38 75     18.8     36.5   2   
 C        34.2 3.79 75     27.4     42.6   2   

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</div>
</section>
<section id="antes-de-continuar-4" class="slide level2 smaller">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment">En este punto, antes de continuar hagamos uso nuevamente del paquete <code>flextable</code> para exportar nuestras tablas a Word.</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb102-2"><a href="#cb102-2"></a>tabla_tukey <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">as.data.frame</span>(tukey_comp)), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb102-3"><a href="#cb102-3"></a>tabla_dunnett <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">as.data.frame</span>(dunnett_comp)), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb102-4"><a href="#cb102-4"></a>tabla_marginal <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(medias_marginales), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-be779538{}.cl-be6d6612{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-be7171a8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be7171bc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be7189ea{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be7189f4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be7189f5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be7189fe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be7189ff{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be718a08{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-be779538"><thead><tr style="overflow-wrap:break-word;"><th class="cl-be7189ea"><p class="cl-be7171a8"><span class="cl-be6d6612">contrast</span></p></th><th class="cl-be7189f4"><p class="cl-be7171bc"><span class="cl-be6d6612">ratio</span></p></th><th class="cl-be7189f4"><p class="cl-be7171bc"><span class="cl-be6d6612">SE</span></p></th><th class="cl-be7189f4"><p class="cl-be7171bc"><span class="cl-be6d6612">df</span></p></th><th class="cl-be7189f4"><p class="cl-be7171bc"><span class="cl-be6d6612">null</span></p></th><th class="cl-be7189f4"><p class="cl-be7171bc"><span class="cl-be6d6612">t.ratio</span></p></th><th class="cl-be7189f4"><p class="cl-be7171bc"><span class="cl-be6d6612">p.value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-be7189f5"><p class="cl-be7171a8"><span class="cl-be6d6612">C / L</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">2.165</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">0.339</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">75</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">1</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">4.936</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-be7189f5"><p class="cl-be7171a8"><span class="cl-be6d6612">C / NL</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">1.307</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">0.262</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">75</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">1</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">1.335</span></p></td><td class="cl-be7189fe"><p class="cl-be7171bc"><span class="cl-be6d6612">0.381</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-be7189ff"><p class="cl-be7171a8"><span class="cl-be6d6612">L / NL</span></p></td><td class="cl-be718a08"><p class="cl-be7171bc"><span class="cl-be6d6612">0.604</span></p></td><td class="cl-be718a08"><p class="cl-be7171bc"><span class="cl-be6d6612">0.121</span></p></td><td class="cl-be718a08"><p class="cl-be7171bc"><span class="cl-be6d6612">75</span></p></td><td class="cl-be718a08"><p class="cl-be7171bc"><span class="cl-be6d6612">1</span></p></td><td class="cl-be718a08"><p class="cl-be7171bc"><span class="cl-be6d6612">-2.516</span></p></td><td class="cl-be718a08"><p class="cl-be7171bc"><span class="cl-be6d6612">0.037</span></p></td></tr></tbody></table></div>
</div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-be859520{}.cl-be7be16a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-be803ce2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be803cec{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be80565a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be805664{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be805665{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be80566e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be80566f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be805678{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-be859520"><thead><tr style="overflow-wrap:break-word;"><th class="cl-be80565a"><p class="cl-be803ce2"><span class="cl-be7be16a">contrast</span></p></th><th class="cl-be805664"><p class="cl-be803cec"><span class="cl-be7be16a">ratio</span></p></th><th class="cl-be805664"><p class="cl-be803cec"><span class="cl-be7be16a">SE</span></p></th><th class="cl-be805664"><p class="cl-be803cec"><span class="cl-be7be16a">df</span></p></th><th class="cl-be805664"><p class="cl-be803cec"><span class="cl-be7be16a">null</span></p></th><th class="cl-be805664"><p class="cl-be803cec"><span class="cl-be7be16a">t.ratio</span></p></th><th class="cl-be805664"><p class="cl-be803cec"><span class="cl-be7be16a">p.value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-be805665"><p class="cl-be803ce2"><span class="cl-be7be16a">L / C</span></p></td><td class="cl-be80566e"><p class="cl-be803cec"><span class="cl-be7be16a">0.462</span></p></td><td class="cl-be80566e"><p class="cl-be803cec"><span class="cl-be7be16a">0.072</span></p></td><td class="cl-be80566e"><p class="cl-be803cec"><span class="cl-be7be16a">75</span></p></td><td class="cl-be80566e"><p class="cl-be803cec"><span class="cl-be7be16a">1</span></p></td><td class="cl-be80566e"><p class="cl-be803cec"><span class="cl-be7be16a">-4.936</span></p></td><td class="cl-be80566e"><p class="cl-be803cec"><span class="cl-be7be16a">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-be80566f"><p class="cl-be803ce2"><span class="cl-be7be16a">NL / C</span></p></td><td class="cl-be805678"><p class="cl-be803cec"><span class="cl-be7be16a">0.765</span></p></td><td class="cl-be805678"><p class="cl-be803cec"><span class="cl-be7be16a">0.153</span></p></td><td class="cl-be805678"><p class="cl-be803cec"><span class="cl-be7be16a">75</span></p></td><td class="cl-be805678"><p class="cl-be803cec"><span class="cl-be7be16a">1</span></p></td><td class="cl-be805678"><p class="cl-be803cec"><span class="cl-be7be16a">-1.335</span></p></td><td class="cl-be805678"><p class="cl-be803cec"><span class="cl-be7be16a">0.318</span></p></td></tr></tbody></table></div>
</div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-be917a70{}.cl-be88f9ea{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-be8c2138{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be8c2142{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-be8c343e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be8c3452{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be8c3453{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be8c345c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be8c345d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-be8c345e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-be917a70"><thead><tr style="overflow-wrap:break-word;"><th class="cl-be8c343e"><p class="cl-be8c2138"><span class="cl-be88f9ea">Pred</span></p></th><th class="cl-be8c3452"><p class="cl-be8c2142"><span class="cl-be88f9ea">response</span></p></th><th class="cl-be8c3452"><p class="cl-be8c2142"><span class="cl-be88f9ea">SE</span></p></th><th class="cl-be8c3452"><p class="cl-be8c2142"><span class="cl-be88f9ea">df</span></p></th><th class="cl-be8c3452"><p class="cl-be8c2142"><span class="cl-be88f9ea">lower.CL</span></p></th><th class="cl-be8c3452"><p class="cl-be8c2142"><span class="cl-be88f9ea">upper.CL</span></p></th><th class="cl-be8c343e"><p class="cl-be8c2138"><span class="cl-be88f9ea">.group</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-be8c3453"><p class="cl-be8c2138"><span class="cl-be88f9ea">L</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">15.799</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">1.748</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">75</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">12.673</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">19.695</span></p></td><td class="cl-be8c3453"><p class="cl-be8c2138"><span class="cl-be88f9ea"> 1 </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-be8c3453"><p class="cl-be8c2138"><span class="cl-be88f9ea">NL</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">26.172</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">4.379</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">75</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">18.754</span></p></td><td class="cl-be8c345c"><p class="cl-be8c2142"><span class="cl-be88f9ea">36.525</span></p></td><td class="cl-be8c3453"><p class="cl-be8c2138"><span class="cl-be88f9ea">  2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-be8c345d"><p class="cl-be8c2138"><span class="cl-be88f9ea">C</span></p></td><td class="cl-be8c345e"><p class="cl-be8c2142"><span class="cl-be88f9ea">34.208</span></p></td><td class="cl-be8c345e"><p class="cl-be8c2142"><span class="cl-be88f9ea">3.786</span></p></td><td class="cl-be8c345e"><p class="cl-be8c2142"><span class="cl-be88f9ea">75</span></p></td><td class="cl-be8c345e"><p class="cl-be8c2142"><span class="cl-be88f9ea">27.440</span></p></td><td class="cl-be8c345e"><p class="cl-be8c2142"><span class="cl-be88f9ea">42.645</span></p></td><td class="cl-be8c345d"><p class="cl-be8c2138"><span class="cl-be88f9ea">  2</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="antes-de-continuar-5" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div class="fragment">
<ul>
<li>La tabla del ANOVA requiere un poquito más de preparación y para ello nos ayudaremos del paquete <code>rstatix</code> para agregar los asteriscos de significancia.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103" data-code-line-numbers="1|2|3|4-8|9-10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb103-2"><a href="#cb103-2"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">Anova</span>(lm2))</span>
<span id="cb103-3"><a href="#cb103-3"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">parametro =</span> <span class="fu">row.names</span>(tabla_anova), tabla_anova)</span>
<span id="cb103-4"><a href="#cb103-4"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">add_significance</span>(tabla_anova, </span>
<span id="cb103-5"><a href="#cb103-5"></a>                 <span class="at">p.col =</span> <span class="st">"Pr(&gt;F)"</span>, </span>
<span id="cb103-6"><a href="#cb103-6"></a>                 <span class="at">output.col =</span> <span class="st">" "</span>,</span>
<span id="cb103-7"><a href="#cb103-7"></a>                 <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),</span>
<span id="cb103-8"><a href="#cb103-8"></a>                 <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"ns"</span>))</span>
<span id="cb103-9"><a href="#cb103-9"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(tabla_anova), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb103-10"><a href="#cb103-10"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">add_footer_lines</span>(tabla_anova, <span class="st">"Códigos Signif. 0 '***', 0.001 '**', 0.1 '*', 0.05 '.', 0.1 'ns'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="antes-de-continuar-6" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<ul>
<li>La tabla del ANOVA requiere un poquito más de preparación y para ello nos ayudaremos del paquete <code>rstatix</code> para agregar los códigos de significancia.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb104-2"><a href="#cb104-2"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">Anova</span>(lm2))</span>
<span id="cb104-3"><a href="#cb104-3"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">parametro =</span> <span class="fu">row.names</span>(tabla_anova), tabla_anova)</span>
<span id="cb104-4"><a href="#cb104-4"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">add_significance</span>(tabla_anova, </span>
<span id="cb104-5"><a href="#cb104-5"></a>                 <span class="at">p.col =</span> <span class="st">"Pr(&gt;F)"</span>, </span>
<span id="cb104-6"><a href="#cb104-6"></a>                 <span class="at">output.col =</span> <span class="st">" "</span>,</span>
<span id="cb104-7"><a href="#cb104-7"></a>                 <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),</span>
<span id="cb104-8"><a href="#cb104-8"></a>                 <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"ns"</span>))</span>
<span id="cb104-9"><a href="#cb104-9"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(tabla_anova), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb104-10"><a href="#cb104-10"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">add_footer_lines</span>(tabla_anova, <span class="st">"Códigos Signif. 0 '***', 0.001 '**', 0.1 '*', 0.05 '.', 0.1 'ns'"</span>)</span>
<span id="cb104-11"><a href="#cb104-11"></a>tabla_anova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-becfdc20{}.cl-bec75bf4{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-beca882e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-beca8838{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-beca9dfa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beca9e04{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beca9e05{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beca9e0e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beca9e0f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beca9e18{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-beca9e19{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-becfdc20"><thead><tr style="overflow-wrap:break-word;"><th class="cl-beca9dfa"><p class="cl-beca882e"><span class="cl-bec75bf4">parametro</span></p></th><th class="cl-beca9e04"><p class="cl-beca8838"><span class="cl-bec75bf4">Sum Sq</span></p></th><th class="cl-beca9e04"><p class="cl-beca8838"><span class="cl-bec75bf4">Df</span></p></th><th class="cl-beca9e04"><p class="cl-beca8838"><span class="cl-bec75bf4">F value</span></p></th><th class="cl-beca9e04"><p class="cl-beca8838"><span class="cl-bec75bf4">Pr(&gt;F)</span></p></th><th class="cl-beca9dfa"><p class="cl-beca882e"><span class="cl-bec75bf4"> </span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-beca9e05"><p class="cl-beca882e"><span class="cl-bec75bf4">Pred</span></p></td><td class="cl-beca9e0e"><p class="cl-beca8838"><span class="cl-bec75bf4">9.710</span></p></td><td class="cl-beca9e0e"><p class="cl-beca8838"><span class="cl-bec75bf4">2</span></p></td><td class="cl-beca9e0e"><p class="cl-beca8838"><span class="cl-bec75bf4">12.389</span></p></td><td class="cl-beca9e0e"><p class="cl-beca8838"><span class="cl-bec75bf4">0.000</span></p></td><td class="cl-beca9e05"><p class="cl-beca882e"><span class="cl-bec75bf4">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-beca9e0f"><p class="cl-beca882e"><span class="cl-bec75bf4">Residuals</span></p></td><td class="cl-beca9e18"><p class="cl-beca8838"><span class="cl-bec75bf4">29.392</span></p></td><td class="cl-beca9e18"><p class="cl-beca8838"><span class="cl-bec75bf4">75</span></p></td><td class="cl-beca9e18"><p class="cl-beca8838"><span class="cl-bec75bf4"></span></p></td><td class="cl-beca9e18"><p class="cl-beca8838"><span class="cl-bec75bf4"></span></p></td><td class="cl-beca9e0f"><p class="cl-beca882e"><span class="cl-bec75bf4"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-beca9e19"><p class="cl-beca882e"><span class="cl-bec75bf4">Códigos Signif. 0 '***', 0.001 '**', 0.1 '*', 0.05 '.', 0.1 'ns'</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="antes-de-continuar-7" class="slide level2" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">save_as_docx</span>(<span class="st">"Tabla Anova"</span> <span class="ot">=</span> tabla_anova, <span class="st">"Tabla Tukey"</span> <span class="ot">=</span> tabla_tukey, <span class="st">"Tabla Dunnett"</span> <span class="ot">=</span> tabla_dunnett,</span>
<span id="cb105-2"><a href="#cb105-2"></a>             <span class="st">"Tabla Medias Marginales Esperadas"</span> <span class="ot">=</span> tabla_marginal,</span>
<span id="cb105-3"><a href="#cb105-3"></a>             <span class="at">path =</span> <span class="st">"C:/Users/mmore/Documents/cursos_2024/see/see-quarto-modulo5/anova.docx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="images/anova_tabla.png" class="r-stretch quarto-figure-center"></section>
<section id="gráficos-de-comparaciones-múltiples" class="slide level2 smaller">
<h2>Gráficos de comparaciones múltiples</h2>
<div>
<ul>
<li class="fragment"><p>Hay personas que prefieren tener representaciones visuales de las comparaciones múltiples.</p></li>
<li class="fragment"><p>Realizar este tipo de gráficos sin embargo solía demandar buena experiencia ya sea en gráficos base o <code>ggplot2</code>.</p></li>
<li class="fragment"><p>Afortunadamente, <code>rstatix</code> nos brinda la posibilidad de llevarlos a cabo de una manera relativamente sencilla.</p></li>
<li class="fragment"><p>La idea es generar un gráfico con las medias marginales observadas de la variable de interés y posicionar sobre este los resultados de las comparaciones múltiples con sus códigos de significancia (o valores p).</p></li>
<li class="fragment"><p>Las desventajas de esta visualización son:</p>
<ul>
<li class="fragment"><p>Tienen mayor sentido realizarlas con HSD Tukey</p></li>
<li class="fragment"><p>Cuando el número de pares de comparaciones es muy grande, el gráfico se vuelve más difícil de interpretar que las tablas.</p></li>
<li class="fragment"><p><code>rstatix</code> no tiene manera de directamente volver a retransformar variables a sus unidades originales.</p></li>
</ul></li>
<li class="fragment"><p>Otro gráfico de cierta popularidad es el de los grupos de Tukey de las medias marginales (gráficos de barras con los números/letras sobre cada categoría). Para esto utilizaremos además el paquete <code>stringr</code></p></li>
</ul>
</div>
</section>
<section id="gráficos-de-comparaciones-múltiples-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Gráficos de comparaciones múltiples</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Código</a></li><li><a href="#tabset-7-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106" data-code-line-numbers="1|2-4|5-7|8-12|13|14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>ranas<span class="sc">$</span>Pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(ranas<span class="sc">$</span>Pred, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"NL"</span>, <span class="st">"L"</span>))</span>
<span id="cb106-2"><a href="#cb106-2"></a>bxplot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(ranas, <span class="at">x =</span> <span class="st">"Pred"</span>, </span>
<span id="cb106-3"><a href="#cb106-3"></a>                    <span class="at">y =</span> <span class="st">"Age.FromEmergence"</span>, </span>
<span id="cb106-4"><a href="#cb106-4"></a>                    <span class="at">color =</span> <span class="st">"Pred"</span>)</span>
<span id="cb106-5"><a href="#cb106-5"></a>hsdvals <span class="ot">&lt;-</span> <span class="fu">emmeans_test</span>(log.Age.FromEmergence <span class="sc">~</span> Pred, </span>
<span id="cb106-6"><a href="#cb106-6"></a>                        <span class="at">data =</span> ranas, </span>
<span id="cb106-7"><a href="#cb106-7"></a>                        <span class="at">p.adjust.method =</span> <span class="st">"mvt"</span>)</span>
<span id="cb106-8"><a href="#cb106-8"></a>hsdvals <span class="ot">&lt;-</span> <span class="fu">add_significance</span>(hsdvals, </span>
<span id="cb106-9"><a href="#cb106-9"></a>                            <span class="at">p.col =</span> <span class="st">"p.adj"</span>, </span>
<span id="cb106-10"><a href="#cb106-10"></a>                            <span class="at">output.col =</span> <span class="st">"p.adj.signif"</span>,</span>
<span id="cb106-11"><a href="#cb106-11"></a>                            <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),</span>
<span id="cb106-12"><a href="#cb106-12"></a>                            <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"ns"</span>))</span>
<span id="cb106-13"><a href="#cb106-13"></a>hsdvals <span class="ot">&lt;-</span> hsdvals <span class="sc">%&gt;%</span> <span class="fu">add_xy_position</span>(<span class="at">x =</span> <span class="st">"Pred"</span>)</span>
<span id="cb106-14"><a href="#cb106-14"></a>bxplot <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(hsdvals, <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">130</span>, <span class="dv">140</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-81-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gráficos-de-comparaciones-múltiples-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Gráficos de comparaciones múltiples</h2>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">Código</a></li><li><a href="#tabset-8-2">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107" data-code-line-numbers="1|2|3|4-7|8-10|11-13|14-15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb107-2"><a href="#cb107-2"></a>gruposvals <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cld</span>(ph1))</span>
<span id="cb107-3"><a href="#cb107-3"></a>gruposvals<span class="sc">$</span>Pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(gruposvals<span class="sc">$</span>Pred, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"NL"</span>, <span class="st">"L"</span>))</span>
<span id="cb107-4"><a href="#cb107-4"></a><span class="fu">ggplot</span>(gruposvals,</span>
<span id="cb107-5"><a href="#cb107-5"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Pred, </span>
<span id="cb107-6"><a href="#cb107-6"></a>           <span class="at">y =</span> response, </span>
<span id="cb107-7"><a href="#cb107-7"></a>           <span class="at">fill =</span> Pred)) <span class="sc">+</span></span>
<span id="cb107-8"><a href="#cb107-8"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb107-9"><a href="#cb107-9"></a>           <span class="at">show.legend =</span> F, </span>
<span id="cb107-10"><a href="#cb107-10"></a>           <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb107-11"><a href="#cb107-11"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> response <span class="sc">-</span> SE, </span>
<span id="cb107-12"><a href="#cb107-12"></a>                    <span class="at">ymax =</span> response <span class="sc">+</span> SE), </span>
<span id="cb107-13"><a href="#cb107-13"></a>                <span class="at">width=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb107-14"><a href="#cb107-14"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">str_trim</span>(.group), </span>
<span id="cb107-15"><a href="#cb107-15"></a>                <span class="at">y =</span> response<span class="sc">+</span>SE, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-83-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="anova-de-un-diseño-desbalanceado" class="slide level2 smaller">
<h2>ANOVA de un diseño desbalanceado</h2>
<div>
<ul>
<li class="fragment"><p>Recordemos que 18 tanques con predadores no letales fueron descartados debido al brote de una enfermedad.</p></li>
<li class="fragment"><p>El diseño original de Touchon era balanceado. Al perderse unidades experimentales, el diseño se le puede denominar como desbalanceado. En otras palabras, el desbalance es la pérdida de observaciones.</p></li>
<li class="fragment"><p>La mayoría de métodos estadísticos requieren ser corregidos ante observaciones perdidas para poder tener la certeza de que los estimados que obtenemos no sean sesgados.</p></li>
<li class="fragment"><p>Sin adentrarnos en mayor detalle, uno de los componentes de la tabla de ANOVA es la suma de cuadrados. Existen tres tipos de suma de cuadrados: I, II y III.</p></li>
<li class="fragment"><p>En breve, las sumas II y III se aconseja sean usadas cuando existen interacciones en el ANOVA.</p></li>
<li class="fragment"><p>En R, la función <code>aov</code> calcula la suma de cuadrados tipo I. Este tipo de suma no es conveniente ante la presencia de desbalance de los datos.</p></li>
<li class="fragment"><p>En cambio, la función <code>Anova</code> del paquete <code>car</code>, usa por default el tipo II que es precisamente el recomendado usar ante la presencia de desbalance.</p></li>
<li class="fragment"><p>En resumen, sí. Hemos utilizado hasta el momento la corrección adecuada para estos datos.</p></li>
</ul>
</div>
</section>
<section id="prueba-de-kruskal-wallis" class="slide level2 smaller">
<h2>Prueba de Kruskal-Wallis</h2>
<div>
<ul>
<li class="fragment"><p>La prueba de Kruskal-Wallis es la alternativa no paramétrica al ANOVA de una vía.</p></li>
<li class="fragment"><p>Puede extenderse al ANOVA de múltiples vías reorganizando el diseño experimental.</p></li>
<li class="fragment"><p>Similar a las pruebas de Wilcoxon, se basa en encontrar diferencias de las medianas en lugar de las medias y su poder es menor.</p></li>
<li class="fragment"><p>Para ilustrar este ejemplo, tomemos la variable <code>Age.DPO</code> del estudio de Touchon y veamos si existen diferencias con respecto al tratamiento de predador <code>Pred</code>. <code>Age.DPO</code> (sin transformaciones no cumple con los supuestos del ANOVA).</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">kruskal.test</span>(Age.DPO <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Age.DPO by Pred
Kruskal-Wallis chi-squared = 22.255, df = 2, p-value = 1.47e-05</code></pre>
</div>
</div>
</div>
</section>
<section id="comparaciones-múltiples-con-kruskal-wallis" class="slide level2 smaller">
<h2>Comparaciones múltiples con Kruskal-Wallis</h2>
<div>
<ul>
<li class="fragment"><p>Con KW también podemos hacer comparaciones múltiples.</p></li>
<li class="fragment"><p>En R base contamos con la función <code>pairwise.wilcox.test</code> que lleva a cabo comparaciones por pares mediante el método de Wilcoxon.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">pairwise.wilcox.test</span>(ranas<span class="sc">$</span>Age.DPO, ranas<span class="sc">$</span>Pred, <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum exact test 

data:  ranas$Age.DPO and ranas$Pred 

   C       NL   
NL 0.303   -    
L  9.8e-06 0.019

P value adjustment method: BH </code></pre>
</div>
</div>
</div>
</section>
<section id="autoevaluación-6" class="slide level2">
<h2>Autoevaluación</h2>
<ul>
<li>Encuentra si existen diferencias en la longitud nariz-cloaca al emerger (<code>SVL.initial</code>) con respecto a los predadores <code>Pred</code> en los datos de Touchon. ¿Qué método es factible usar?, ¿ANOVA de una vía o Kruskal-Wallis?</li>
</ul>
</section>
<section id="anova-de-múltiples-vías" class="slide level2 smaller">
<h2>ANOVA de múltiples vías</h2>
<div>
<ul>
<li class="fragment"><p>El ANOVA puede extenderse para analizar dos o más factores a la vez. Su nombre entonces varía dependiendo de cuántos factores analicemos, así: ANOVA de dos vías (2 factores), ANOVA de tres vías (3 factores) …</p></li>
<li class="fragment"><p>En la práctica es recomendable diseñar experimentos hasta máximo 3 factores:</p>
<ul>
<li class="fragment"><p>A más factores, más costosa la investigación</p></li>
<li class="fragment"><p>A más factores, sus interacciones son más difíciles de interpretar</p></li>
<li class="fragment"><p>Es posible inclusive que tengamos resultados sin sentido (interacciones innecesarias)</p></li>
</ul></li>
<li class="fragment"><p>¿Qué son las interacciones?</p>
<ul>
<li class="fragment"><p>Una interacción se refiere cuando los niveles de un factor podrían depender de los niveles de otro.</p></li>
<li class="fragment"><p>Por ejemplo, con los datos de las ranas, podríamos imaginar que en la ausencia de predadores, tener recursos altos o bajos podría influenciar el tiempo que tomaron los renacuajos en culminar la metamorfosis. Es decir, si hay predadores presentes, podría darse el caso de que las presas se escondan y coman menos influenciando así ese tiempo.</p></li>
<li class="fragment"><p>Así, podríamos saber si el effecto de los recursos son influenciados ante la presencia de predadores</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="anova-de-múltiples-vías-en-r" class="slide level2 smaller scrollable">
<h2>ANOVA de múltiples vías en R</h2>
<div>
<ul>
<li class="fragment"><p>Vamos a usar nuevamente los datos de Touchon, la variable de respuesta es la edad de metamorfosis <code>Age.DPO</code> y los factores la presencia de predadores <code>Pred</code> y los recursos <code>Res</code>.</p></li>
<li class="fragment"><p>Para un ANOVA de múltiples vías en R podemos usar la siguiente sintaxis: <code>Factor1*Factor2</code></p></li>
<li class="fragment"><p>Para ahorrarnos tiempo, supóngamos que ya corrimos un primer ANOVA, y encontramos que usando el logaritmo de <code>Age.DPO</code> podemos normalizar los residuos. <span class="fragment">Pero nos encontramos con esto:</span></p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> Pred<span class="sc">*</span>Res, <span class="at">data =</span> ranas)</span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="fu">leveneTest</span>(lm4, <span class="at">center =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "mean")
      Df F value    Pr(&gt;F)    
group  5  6.0253 0.0001033 ***
      72                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div>
<ul>
<li class="fragment"><p><strong>¡La homogeneidad de las varianzas no se cumple!</strong> 😱</p></li>
<li class="fragment"><p>¡Ninguna otra transformación funciona!</p></li>
</ul>
</div>
</div>
</section>
<section id="anova-de-múltiples-vías-en-r-1" class="slide level2" data-visibility="uncounted">
<h2>ANOVA de múltiples vías en R</h2>

<img data-src="images/reir.jpg" class="r-stretch quarto-figure-center"></section>
<section id="anova-de-múltiples-vías-en-r-2" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>ANOVA de múltiples vías en R</h2>
<div>
<ul>
<li class="fragment"><p>A parte de reir, en este tipo de situaciones (que son bastante comunes), tenemos dos alternativas:</p>
<ol type="1">
<li class="fragment"><p>Realizar pruebas no paramétricas, o</p></li>
<li class="fragment"><p>Calcular ANOVAs con correcciones para heterocedasticidad.</p></li>
</ol></li>
<li class="fragment"><p>Pero como acuñó el Ec. y estadístico Milton Friedman: <a href="https://en.wikipedia.org/wiki/There_ain%27t_no_such_thing_as_a_free_lunch" target="_blank"><em>“No existe tal cosa como un almuerzo gratis”</em></a>, usar la segunda opción no es tan fácil como hemos venido viendo.</p></li>
<li class="fragment"><p>En R, tenemos estos caminos (de peor a mejor opción):</p>
<ol type="1">
<li class="fragment"><p>Realizar el ANOVA usando la corrección de White-Huber disponible en la librería <code>car</code>, pero al costo de conducir comparaciones múltiples posiblemente sesgadas (siguiendo la lógica de realizarlas con <code>emmeans</code>).</p></li>
<li class="fragment"><p>Utilizar <code>rstatix</code> para un ANOVA con la corrección de Welch, seguido de comparaciones múltiples con la corrección de Games-Howell y poder todavía realizar sus gráficos al costo de romper la secuencia de aprendizaje que hemos venido llevando para el ANOVA.</p></li>
<li class="fragment"><p>Utilizar las librerías <code>nlme</code> para reparametrizar el modelo en forma de un modelo lineal generalizado, y posteriormente usar <code>car</code> y <code>emmeans</code> para el ANOVA y las comparaciones múltiples, respectivamente. Pero al costo de no poder graficarlas con <code>rstatix</code> sino desde 0.</p></li>
</ol></li>
<li class="fragment"><p>A continuación entonces iremos en este orden de las opciones: 2, 3 y 1 (la última para ejemplificar cuál sería el camino suponiendo que la homocedasticidad se hubiese cumplido).</p></li>
</ul>
</div>
</section>
<section id="anova-de-múltiples-vías-en-r.-opc.-2" class="slide level2 smaller scrollable">
<h2>ANOVA de múltiples vías en R. Opc. 2</h2>
<div>
<ul>
<li class="fragment"><p>El inconveniente de usar la corrección de Welch es que esta se puede aplicar solo a ANOVAs de una vía.</p></li>
<li class="fragment"><p>Entonces, de manera similar a lo hicimos para poder analizar por Kruskall-Wallis un diseño factorial, tenemos que crear una variable dummy combinando los dos factores para correr un ANOVA de una vía.</p></li>
<li class="fragment"><p><strong>Debemos tener en cuenta que</strong> al realizar esto, reducimos poder de la prueba estadística.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>ranas<span class="sc">$</span>log.Age.DPO <span class="ot">&lt;-</span> <span class="fu">log</span>(ranas<span class="sc">$</span>Age.DPO)</span>
<span id="cb114-2"><a href="#cb114-2"></a>ranas<span class="sc">$</span>tratamiento <span class="ot">&lt;-</span> <span class="fu">paste</span>(ranas<span class="sc">$</span>Pred, ranas<span class="sc">$</span>Res, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb114-3"><a href="#cb114-3"></a>anova_op2 <span class="ot">&lt;-</span> ranas <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4"></a>  <span class="fu">welch_anova_test</span>(log.Age.DPO <span class="sc">~</span> tratamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="anova-de-múltiples-vías-en-r.-opc.-2-1" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>ANOVA de múltiples vías en R. Opc. 2</h2>
<ul>
<li><p>El inconveniente de usar la corrección de Welch es que esta se puede aplicar solo a ANOVAs de una vía.</p></li>
<li><p>Entonces, de manera similar a lo hicimos para poder analizar por Kruskall-Wallis un diseño factorial, tenemos que crear una variable dummy combinando los dos factores para correr un ANOVA de una vía.</p></li>
<li><p><strong>Debemos tener en cuenta que</strong> al realizar esto, reducimos poder de la prueba estadística.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>ranas<span class="sc">$</span>log.Age.DPO <span class="ot">&lt;-</span> <span class="fu">log</span>(ranas<span class="sc">$</span>Age.DPO)</span>
<span id="cb115-2"><a href="#cb115-2"></a>ranas<span class="sc">$</span>tratamiento <span class="ot">&lt;-</span> <span class="fu">paste</span>(ranas<span class="sc">$</span>Pred, ranas<span class="sc">$</span>Res, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb115-3"><a href="#cb115-3"></a>ranas<span class="sc">$</span>tratamiento <span class="ot">&lt;-</span> <span class="fu">factor</span>(ranas<span class="sc">$</span>tratamiento, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C-Lo"</span>, <span class="st">"NL-Lo"</span>, <span class="st">"C-Hi"</span>, <span class="st">"L-Lo"</span>, <span class="st">"NL-Hi"</span>, <span class="st">"L-Hi"</span>))</span>
<span id="cb115-4"><a href="#cb115-4"></a>anova_op2 <span class="ot">&lt;-</span> ranas <span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="#cb115-5"></a>  <span class="fu">welch_anova_test</span>(log.Age.DPO <span class="sc">~</span> tratamiento)</span>
<span id="cb115-6"><a href="#cb115-6"></a>anova_op2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.             n statistic   DFn   DFd           p method     
* &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;      
1 log.Age.DPO    78      17.2     5  24.0 0.000000305 Welch ANOVA</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Ahora podemos realizar las comparaciones de HSD Tukey (con corrección de Games-Howell)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>games_comp <span class="ot">&lt;-</span> ranas <span class="sc">%&gt;%</span> <span class="fu">games_howell_test</span>(log.Age.DPO <span class="sc">~</span> tratamiento)</span>
<span id="cb117-2"><a href="#cb117-2"></a>games_comp <span class="ot">&lt;-</span> <span class="fu">add_significance</span>(games_comp, </span>
<span id="cb117-3"><a href="#cb117-3"></a>                                <span class="at">p.col =</span> <span class="st">"p.adj"</span>, </span>
<span id="cb117-4"><a href="#cb117-4"></a>                                <span class="at">output.col =</span> <span class="st">"p.adj.signif"</span>,</span>
<span id="cb117-5"><a href="#cb117-5"></a>                                <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),</span>
<span id="cb117-6"><a href="#cb117-6"></a>                                <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"ns"</span>))</span>
<span id="cb117-7"><a href="#cb117-7"></a>games_comp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 8
   .y.         group1 group2 estimate conf.low conf.high      p.adj p.adj.signif
   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
 1 log.Age.DPO C-Lo   NL-Lo  -0.155     -0.772    0.462  0.936      ns          
 2 log.Age.DPO C-Lo   C-Hi   -0.440     -0.700   -0.180  0.000261   ***         
 3 log.Age.DPO C-Lo   L-Lo   -0.485     -0.754   -0.217  0.0000932  ***         
 4 log.Age.DPO C-Lo   NL-Hi  -0.493     -0.821   -0.166  0.002      **          
 5 log.Age.DPO C-Lo   L-Hi   -0.643     -0.877   -0.408  0.00000114 ***         
 6 log.Age.DPO NL-Lo  C-Hi   -0.285     -0.902    0.331  0.545      ns          
 7 log.Age.DPO NL-Lo  L-Lo   -0.331     -0.947    0.286  0.419      ns          
 8 log.Age.DPO NL-Lo  NL-Hi  -0.339     -0.961    0.284  0.433      ns          
 9 log.Age.DPO NL-Lo  L-Hi   -0.488     -1.11     0.133  0.129      ns          
10 log.Age.DPO C-Hi   L-Lo   -0.0452    -0.258    0.168  0.986      ns          
11 log.Age.DPO C-Hi   NL-Hi  -0.0531    -0.351    0.244  0.988      ns          
12 log.Age.DPO C-Hi   L-Hi   -0.202     -0.362   -0.0425 0.008      **          
13 log.Age.DPO L-Lo   NL-Hi  -0.00797   -0.310    0.294  1          ns          
14 log.Age.DPO L-Lo   L-Hi   -0.157     -0.334    0.0196 0.099      .           
15 log.Age.DPO NL-Hi  L-Hi   -0.149     -0.440    0.142  0.448      ns          </code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Finalizamos con el gráfico de estas</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>games_comp <span class="ot">&lt;-</span> games_comp <span class="sc">%&gt;%</span> </span>
<span id="cb119-2"><a href="#cb119-2"></a>  <span class="fu">add_xy_position</span>(<span class="at">x =</span> <span class="st">"tratamiento"</span>, <span class="at">step.increase =</span> <span class="dv">1</span>)</span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="fu">ggboxplot</span>(ranas,</span>
<span id="cb119-4"><a href="#cb119-4"></a>          <span class="at">x =</span> <span class="st">"tratamiento"</span>,</span>
<span id="cb119-5"><a href="#cb119-5"></a>          <span class="at">y =</span> <span class="st">"log.Age.DPO"</span>) <span class="sc">+</span> </span>
<span id="cb119-6"><a href="#cb119-6"></a>  <span class="fu">stat_pvalue_manual</span>(games_comp, </span>
<span id="cb119-7"><a href="#cb119-7"></a>                     <span class="at">hide.ns =</span> T,</span>
<span id="cb119-8"><a href="#cb119-8"></a>                     <span class="at">y.position =</span> <span class="fu">c</span>(<span class="fl">5.1</span>,<span class="fl">5.5</span>,<span class="fl">5.9</span>,<span class="fl">6.3</span>,<span class="fl">6.7</span>,<span class="fl">7.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-90-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="anova-de-múltiples-vías-en-r.-opc.-3" class="slide level2 smaller scrollable">
<h2>ANOVA de múltiples vías en R. Opc. 3</h2>
<div>
<ul>
<li class="fragment"><p>La tercera opción involucra el reparametrizar el modelo para poder analizarlo como un modelo lineal generalizado.</p></li>
<li class="fragment"><p>En breve, una de las ventajas de los modelos lineales generalizados es que pueden asumir varianzas distintas a través de modelar directamente la heterocedasticidad.</p></li>
<li class="fragment"><p>Para su implementación usaremos la librería <code>nlme</code></p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb120-2"><a href="#cb120-2"></a>anova_op3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> Pred<span class="sc">*</span>Res,</span>
<span id="cb120-3"><a href="#cb120-3"></a>                 <span class="at">data =</span> ranas,</span>
<span id="cb120-4"><a href="#cb120-4"></a>                 <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Pred<span class="sc">*</span>Res)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Mediante la librería <code>car</code> podemos obtener la tabla del ANOVA (o especificamente llamada Analisis de Desviación)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">Anova</span>(anova_op3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: log(Age.DPO)
         Df   Chisq Pr(&gt;Chisq)    
Pred      2 41.5704  9.400e-10 ***
Res       1 30.6580  3.078e-08 ***
Pred:Res  2  8.0607    0.01777 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Ahora, usando <code>emmeans</code> podemos calcular el HSD de Tukey directamente sin necesidad de correcciones. Una consideración importante es que, cuando tenemos dos factores debemos hacer las comparaciones de cada factor a la vez a lo largo de los niveles del otro.</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>tukey_comp_pred <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_op3, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">by =</span> <span class="st">"Res"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>) <span class="co"># medias marginales esperadas</span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="fu">contrast</span>(tukey_comp_pred, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">by =</span> <span class="st">"Res"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Res = Hi:
 contrast estimate     SE    df t.ratio p.value
 C - NL     0.0531 0.0873 10.98   0.608  0.8186
 C - L      0.2022 0.0509 20.62   3.971  0.0020
 NL - L     0.1491 0.0765  6.94   1.949  0.1959

Res = Lo:
 contrast estimate     SE    df t.ratio p.value
 C - NL     0.1548 0.1717  8.55   0.901  0.6536
 C - L      0.4854 0.0879 27.51   5.526  &lt;.0001
 NL - L     0.3306 0.1650  7.37   2.004  0.1783

Degrees-of-freedom method: satterthwaite 
Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>tukey_comp_res <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_op3, <span class="at">specs =</span> <span class="st">"Res"</span>, <span class="at">by =</span> <span class="st">"Pred"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>) <span class="co"># medias marginales esperadas</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="fu">contrast</span>(tukey_comp_res, <span class="at">specs =</span> <span class="st">"Res"</span>, <span class="at">by =</span> <span class="st">"Pred"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pred = C:
 contrast estimate     SE    df t.ratio p.value
 Hi - Lo    -0.440 0.0847 26.09  -5.199  &lt;.0001

Pred = NL:
 contrast estimate     SE    df t.ratio p.value
 Hi - Lo    -0.339 0.1730  8.52  -1.957  0.0839

Pred = L:
 contrast estimate     SE    df t.ratio p.value
 Hi - Lo    -0.157 0.0560 18.93  -2.803  0.0114

Degrees-of-freedom method: satterthwaite 
Results are given on the log (not the response) scale. </code></pre>
</div>
</div>
<ul>
<li>Para graficar estas comparaciones mediante esta opción es necesario el empezar de cero con <code>ggplot2</code>. La razón es que <code>rstatix</code> no tiene las capacidades de lidiar con interacciones provenientes de <code>emmeans</code> (no es compatible con la sintaxis de los comandos <code>contrast</code> de arriba) por lo que dejaremos esta opción hasta aquí.</li>
</ul>
</div>
</section>
<section id="anova-de-múltiples-vías-en-r.-opc.-1" class="slide level2 smaller scrollable">
<h2>ANOVA de múltiples vías en R. Opc. 1</h2>
<div>
<ul>
<li class="fragment"><p>Finalmente, asumamos que no tuvimos el problema de heterocedasticidad y pudimos haber seguido el curso normal para realizar las comparaciones múltiples usando solamente <code>car</code>, <code>emmeans</code> y <code>multcomp</code>.</p></li>
<li class="fragment"><p>Este es el transcurso normal de tópicos en el aprendizaje del ANOVA de múltiples vías:</p></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Tabla del ANOVA con <code>car</code> (mencionamos que <code>car</code> es capaz de llevar a cabo una corrección de heterocedasticidad, esta se consigue agregando el argumento <code>white.adjust = T</code> dentro de la función <code>Anova</code>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="fu">Anova</span>(lm4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: log(Age.DPO)
          Sum Sq Df F value    Pr(&gt;F)    
Pred      1.9446  2 18.7561 2.775e-07 ***
Res       1.8241  1 35.1871 9.576e-08 ***
Pred:Res  0.3254  2  3.1384   0.04934 *  
Residuals 3.7324 72                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Al igual que en la opción 3, calculamos las comparaciones múltiples viendo a cada factor a la vez a lo largo de los niveles del otro.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>tukey_comp_pred1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm4, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">by =</span> <span class="st">"Res"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb129-2"><a href="#cb129-2"></a><span class="fu">contrast</span>(tukey_comp_pred1, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Res = Hi:
 contrast ratio     SE df null t.ratio p.value
 C / NL    1.05 0.1088 72    1   0.515  0.8644
 C / L     1.22 0.0985 72    1   2.512  0.0374
 NL / L    1.16 0.1198 72    1   1.445  0.3234

Res = Lo:
 contrast ratio     SE df null t.ratio p.value
 C / NL    1.17 0.1205 72    1   1.500  0.2968
 C / L     1.62 0.1308 72    1   6.030  &lt;.0001
 NL / L    1.39 0.1436 72    1   3.204  0.0057

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a>tukey_comp_res1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm4, <span class="at">specs =</span> <span class="st">"Res"</span>, <span class="at">by =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="fu">contrast</span>(tukey_comp_res1, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>, <span class="at">adjust =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pred = C:
 contrast ratio     SE df null t.ratio p.value
 Hi / Lo  0.644 0.0518 72    1  -5.470  &lt;.0001

Pred = NL:
 contrast ratio     SE df null t.ratio p.value
 Hi / Lo  0.713 0.0867 72    1  -2.782  0.0069

Pred = L:
 contrast ratio     SE df null t.ratio p.value
 Hi / Lo  0.855 0.0688 72    1  -1.951  0.0549

Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
</section>
<section id="antes-de-continuar-8" class="slide level2 smaller">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment"><p>Muchas personas gustan de las tablas de grupos de Tukey para las medias marginales esperadas en diseños experimentales factoriales al estilo que usamos para poder conducir la opción 2 anteriormente descrita.</p></li>
<li class="fragment"><p>Esta práctica es innecesaria si el investigador es capaz de hacer buenas inferencias basándose en las comparaciones por factor a lo largo de los niveles del otro.</p></li>
<li class="fragment"><p>No tienen ningún problema operacional ya que a la final es una reparametrización válida del modelo.</p></li>
<li class="fragment"><p>Sin embargo, cuando el modelo sobre el cual son aplicadas es incorrecto, son más susceptibles de reflejar valores p que concluyen con inferencias falaces.</p></li>
<li class="fragment"><p>En el largo ejemplo de las opciones a mano para lidiar con heterocedasticidad, podemos con seguridad afirmar que del peor al mejor modelo su orden sería: Opción 1 &lt; Opción 2 &lt; Opción 3.</p></li>
<li class="fragment"><p>Para ilustrar esto, con la variable dummy que creamos en la opción 2, calculemos los grupos Tukey de las medias marginales esperadas en las opciones 1 y 3 para su comparación.</p></li>
</ul>
</div>
</section>
<section id="antes-de-continuar-9" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div class="fragment">
<ul>
<li>Grupos Tukey de las medias marginales esperadas en la opción 1</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>lm_op1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> tratamiento, <span class="at">data =</span> ranas)</span>
<span id="cb133-2"><a href="#cb133-2"></a>emm_op1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm_op1, <span class="at">specs =</span> <span class="st">"tratamiento"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb133-3"><a href="#cb133-3"></a>t_grupos_op1 <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_op1, <span class="at">specs =</span> <span class="st">"tratamiento"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>)</span>
<span id="cb133-4"><a href="#cb133-4"></a>t_grupos_op1 <span class="ot">&lt;-</span> <span class="fu">add_significance</span>(<span class="fu">as.data.frame</span>(t_grupos_op1), </span>
<span id="cb133-5"><a href="#cb133-5"></a>                                <span class="at">p.col =</span> <span class="st">"p.value"</span>, </span>
<span id="cb133-6"><a href="#cb133-6"></a>                                <span class="at">output.col =</span> <span class="st">"p.adj.signif.op1"</span>,</span>
<span id="cb133-7"><a href="#cb133-7"></a>                                <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),</span>
<span id="cb133-8"><a href="#cb133-8"></a>                                <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"ns"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Grupos Tukey de las medias marginales esperadas en la opción 3</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>lm_op3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> tratamiento,</span>
<span id="cb134-2"><a href="#cb134-2"></a>                 <span class="at">data =</span> ranas,</span>
<span id="cb134-3"><a href="#cb134-3"></a>                 <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>tratamiento)) </span>
<span id="cb134-4"><a href="#cb134-4"></a>emm_op3 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm_op3, <span class="at">specs =</span> <span class="st">"tratamiento"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb134-5"><a href="#cb134-5"></a>t_grupos_op3 <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_op3, <span class="at">specs =</span> <span class="st">"tratamiento"</span>, <span class="at">method =</span> <span class="st">"tukey"</span>)</span>
<span id="cb134-6"><a href="#cb134-6"></a>t_grupos_op3 <span class="ot">&lt;-</span> <span class="fu">add_significance</span>(<span class="fu">as.data.frame</span>(t_grupos_op3), </span>
<span id="cb134-7"><a href="#cb134-7"></a>                                <span class="at">p.col =</span> <span class="st">"p.value"</span>, </span>
<span id="cb134-8"><a href="#cb134-8"></a>                                <span class="at">output.col =</span> <span class="st">"p.adj.signif.op3"</span>,</span>
<span id="cb134-9"><a href="#cb134-9"></a>                                <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),</span>
<span id="cb134-10"><a href="#cb134-10"></a>                                <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">"ns"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Un poco de carpintería</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="fu">colnames</span>(games_comp)[<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p.value.op2"</span>, <span class="st">"p.adj.signif.op2"</span>)</span>
<span id="cb135-2"><a href="#cb135-2"></a><span class="fu">colnames</span>(t_grupos_op3)[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="st">"p.value.op3"</span></span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="fu">colnames</span>(t_grupos_op1)[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="st">"p.value.op1"</span></span>
<span id="cb135-4"><a href="#cb135-4"></a></span>
<span id="cb135-5"><a href="#cb135-5"></a>comp_table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t_grupos_op3[,<span class="dv">1</span>],</span>
<span id="cb135-6"><a href="#cb135-6"></a>                    t_grupos_op1[,<span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>)],</span>
<span id="cb135-7"><a href="#cb135-7"></a>                    games_comp[,<span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>)],</span>
<span id="cb135-8"><a href="#cb135-8"></a>                    t_grupos_op3[,<span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>)])</span>
<span id="cb135-9"><a href="#cb135-9"></a></span>
<span id="cb135-10"><a href="#cb135-10"></a>comp_table <span class="ot">&lt;-</span> <span class="fu">flextable</span>(comp_table)</span>
<span id="cb135-11"><a href="#cb135-11"></a>final_comp_table <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(comp_table, <span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb135-12"><a href="#cb135-12"></a>final_comp_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-c0d99812{}.cl-c0cfc940{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c0d30236{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c0d30240{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c0d31532{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c0d3153c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c0d31546{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c0d31547{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c0d31550{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c0d31551{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c0d99812"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c0d31532"><p class="cl-c0d30236"><span class="cl-c0cfc940">t_grupos_op3[, 1]</span></p></th><th class="cl-c0d3153c"><p class="cl-c0d30240"><span class="cl-c0cfc940">p.value.op1</span></p></th><th class="cl-c0d31532"><p class="cl-c0d30236"><span class="cl-c0cfc940">p.adj.signif.op1</span></p></th><th class="cl-c0d3153c"><p class="cl-c0d30240"><span class="cl-c0cfc940">p.value.op2</span></p></th><th class="cl-c0d31532"><p class="cl-c0d30236"><span class="cl-c0cfc940">p.adj.signif.op2</span></p></th><th class="cl-c0d3153c"><p class="cl-c0d30240"><span class="cl-c0cfc940">p.value.op3</span></p></th><th class="cl-c0d31532"><p class="cl-c0d30236"><span class="cl-c0cfc940">p.adj.signif.op3</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Lo) / (NL-Lo)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.665</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.936</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.936</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Lo) / (C-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Lo) / (L-Lo)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Lo) / (NL-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.002</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">**</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.002</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">**</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Lo) / (L-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(NL-Lo) / (C-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.075</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">.</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.545</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.545</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(NL-Lo) / (L-Lo)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.024</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">*</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.419</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.419</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(NL-Lo) / (NL-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.072</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">.</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.433</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.433</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(NL-Lo) / (L-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">***</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.129</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.129</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Hi) / (L-Lo)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.993</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.986</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.987</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Hi) / (NL-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.995</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.988</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.988</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(C-Hi) / (L-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.134</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.008</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">**</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.009</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">**</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(L-Lo) / (NL-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">1.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">1.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">1.000</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">(L-Lo) / (L-Hi)</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.380</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.099</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">.</span></p></td><td class="cl-c0d31547"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.097</span></p></td><td class="cl-c0d31546"><p class="cl-c0d30236"><span class="cl-c0cfc940">.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c0d31550"><p class="cl-c0d30236"><span class="cl-c0cfc940">(NL-Hi) / (L-Hi)</span></p></td><td class="cl-c0d31551"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.699</span></p></td><td class="cl-c0d31550"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31551"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.448</span></p></td><td class="cl-c0d31550"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td><td class="cl-c0d31551"><p class="cl-c0d30240"><span class="cl-c0cfc940">0.447</span></p></td><td class="cl-c0d31550"><p class="cl-c0d30236"><span class="cl-c0cfc940">ns</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="gráficos-de-interacción" class="slide level2 smaller">
<h2>Gráficos de interacción</h2>
<div>
<ul>
<li class="fragment"><p>Es una forma de representar las predicciones lineales de un modelo con respecto a los niveles de sus factores.</p></li>
<li class="fragment"><p>Es recomendable usarlos con factores de hasta 3 niveles y en ANOVAS de dos factores así como también con las medias marginales esperadas.</p></li>
<li class="fragment"><p>Existen diversas formas de realizarlos en R:</p>
<ul>
<li class="fragment"><p>Librería base de R (solo puede hacerlo con medias marginales observadas<span class="fragment">… al menos hasta donde tengo conocimiento)</span></p></li>
<li class="fragment"><p>Construirlos desde cero con <code>ggplot2</code> (para las opciones 2 y 3).</p></li>
<li class="fragment"><p>Usar librerías accesorias de <code>ggplot2</code> como <code>interactions</code>. (Esta alternativa solo es válida para la primera opción que presentamos)</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="gráficos-de-interacción-en-r" class="slide level2 scrollable">
<h2>Gráficos de interacción en R</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb136-2"><a href="#cb136-2"></a>graf_inter1 <span class="ot">&lt;-</span> <span class="fu">cat_plot</span>(</span>
<span id="cb136-3"><a href="#cb136-3"></a>  lm4,</span>
<span id="cb136-4"><a href="#cb136-4"></a>  <span class="at">pred =</span> Pred,</span>
<span id="cb136-5"><a href="#cb136-5"></a>  <span class="at">modx =</span> Res,</span>
<span id="cb136-6"><a href="#cb136-6"></a>  <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb136-7"><a href="#cb136-7"></a>  <span class="at">data =</span> ranas</span>
<span id="cb136-8"><a href="#cb136-8"></a>)</span>
<span id="cb136-9"><a href="#cb136-9"></a>graf_inter1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-102-1.png" width="960"></p>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb137-2"><a href="#cb137-2"></a>graf_inter2 <span class="ot">&lt;-</span> <span class="fu">cat_plot</span>(</span>
<span id="cb137-3"><a href="#cb137-3"></a>  lm4,</span>
<span id="cb137-4"><a href="#cb137-4"></a>  <span class="at">pred =</span> Res,</span>
<span id="cb137-5"><a href="#cb137-5"></a>  <span class="at">modx =</span> Pred,</span>
<span id="cb137-6"><a href="#cb137-6"></a>  <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb137-7"><a href="#cb137-7"></a>  <span class="at">data =</span> ranas</span>
<span id="cb137-8"><a href="#cb137-8"></a>)</span>
<span id="cb137-9"><a href="#cb137-9"></a>graf_inter2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-104-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="autoevaluación-7" class="slide level2">
<h2>Autoevaluación</h2>
<ul>
<li><p>Lleva a cabo un ANOVA de dos vías para las variables <code>Resorb.days</code> y los factores <code>Pred</code> y <code>Res</code>. La pregunta a investigar es saber si existe una interacción entre la presencia de predadores a distintos niveles de recursos que afecte el tiempo de reabsorción de la cola en los renacuajos de ranas arbóreas de ojos rojos.</p></li>
<li><p>A pesar de que el modelo para <code>Resorb.day</code> que acabas de hacer cumple con los supuestos del ANOVA, solo por aprendizaje, conduce una prueba de Kruskal-Wallis usando los mismos factores.</p></li>
</ul>
</section></section>
<section>
<section id="regresión-lineal" class="title-slide slide level1 center">
<h1>Regresión lineal</h1>

</section>
<section id="introducción-1" class="slide level2 smaller">
<h2>Introducción</h2>
<div>
<ul>
<li class="fragment"><p>Otro modelo estadístico ampliamente usado es la regresión lineal.</p></li>
<li class="fragment"><p>Se diferencia del ANOVA al considerar un predictor continuo (no un factor categórico).</p></li>
<li class="fragment"><p>Los supuestos de la regresión lineal son:</p>
<ul>
<li class="fragment"><p>Existencia de una relación lineal entre las variables continuas objeto de la regresión</p></li>
<li class="fragment"><p>Normalidad de los residuos</p></li>
<li class="fragment"><p>Que no exista multicolinearidad (en el caso de regresión múltiple)</p></li>
<li class="fragment"><p>Que no exista auto correlación (que las observaciones no dependan una de otra dentro de una misma variable)</p></li>
<li class="fragment"><p>Homogeneidad de la varianza de los residuos</p></li>
</ul></li>
<li class="fragment"><p>Contrario al ANOVA, no existen correcciones o métodos alternativos cuando las transformaciones fallan.</p></li>
<li class="fragment"><p>Por esto, lo que se recomienda hacer es mencionar todos los detalles de la conducción del modelo. <span class="fragment">Cosa que rara vez pasa.</span></p></li>
<li class="fragment"><p>En regresión lineal es quizá en el método que más se abusa del remover outliers.</p></li>
</ul>
</div>
</section>
<section id="regresión-lineal-en-r" class="slide level2 smaller">
<h2>Regresión lineal en R</h2>
<div>
<ul>
<li class="fragment"><p>Usando los datos de Touchon, podríamos preguntarnos si el tamaño de las ranas al final de la metamorfosis <code>SVL.final</code> está influenciado por la edad en finalizar la metamorfosis <code>Age.DPO</code>.</p></li>
<li class="fragment"><p>Esta regresión lineal sería de la siguiente forma:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>lm6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SVL.final <span class="sc">~</span> Age.DPO, <span class="at">data =</span> ranas)</span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="fu">summary</span>(lm6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SVL.final ~ Age.DPO, data = ranas)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1414 -0.9521 -0.1297  0.6842  3.4349 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 21.285436   0.416763  51.073  &lt; 2e-16 ***
Age.DPO     -0.029437   0.006052  -4.864 6.08e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.262 on 76 degrees of freedom
Multiple R-squared:  0.2374,    Adjusted R-squared:  0.2273 
F-statistic: 23.65 on 1 and 76 DF,  p-value: 6.081e-06</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Pero antes de cualquier inferencia, vamos a darle un vistazo a los diagnósticos de la regresión lineal</li>
</ul>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal" class="slide level2">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb140-2"><a href="#cb140-2"></a><span class="fu">plot</span>(lm6)</span>
<span id="cb140-3"><a href="#cb140-3"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal-1" class="slide level2" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-107-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="diagnósticos-de-la-regresión-lineal-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-108-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Residuos vs.&nbsp;Valores ajustados</strong></p>
<p>En el ANOVA vimos como este plot sugería departuras de la homocedasticidad. En el caso de la regresión lineal, los residuos al no estar agrupados en categorías presentan mayor información sobre este supuesto. Adicionalmente, curvaturas en la línea roja evidencian también departuras de la linearidad. Esto quiere decir que la relación entre las variables no es completamente lineal. A veces esto puede corregirse con transformaciones.</p>
</div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal-3" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>

<img data-src="images/kutner.png" class="r-stretch quarto-figure-center"><ol type="a">
<li>Es ideal. (b) Es indicativo de no linearidad. (c) Evidencia de heterocedasticidad. (d) Evidencia de una tendencia temporal</li>
</ol>
</section>
<section id="diagnósticos-de-la-regresión-lineal-4" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-109-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Gráfico Q-Q</strong></p>
<p>Misma explicación que antes</p>
</div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal-5" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-110-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Raíz cuadrada de los residuos estandarizados vs.&nbsp;Valores ajustados</strong></p>
<p>Misma explicación que antes</p>
</div>
</div>
</section>
<section id="diagnósticos-de-la-regresión-lineal-6" class="slide level2 smaller" data-visibility="uncounted">
<h2>Diagnósticos de la regresión lineal</h2>
<div class="columns v-center-container">
<div class="column fragment" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-111-1.png" width="576"></p>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Residuos vs.&nbsp;Apalancamiento</strong></p>
<p>Aquellos puntos que estén etiquetados con números son mostrados como posibles outliers bajo dos criterios:</p>
<ul>
<li><p>Están por fuera de los límites de la regla del rango intercuartílico (IQR), y</p></li>
<li><p>Marcados como outliers con influencia de apalancamiento mediante la prueba de Cook (distancia de Cook).</p></li>
</ul>
<p>El segundo criterio es un argumento sólido para remover outliers.</p>
</div>
</div>
</section>
<section id="pruebas-formales-de-los-supuestos" class="slide level2 smaller">
<h2>Pruebas formales de los supuestos</h2>
<div>
<ul>
<li class="fragment"><p>Como vimos, los supuestos de la regresión lineal son más que para el ANOVA.</p></li>
<li class="fragment"><p>Existen varias pruebas formales para chequear cada uno de sus supuestos, sin embargo rara vez son empleadas.</p></li>
<li class="fragment"><p>La razón yace en que si los aplicáramos todo el tiempo, no haríamos regresiones lineales ni el 10% de las veces.</p></li>
<li class="fragment"><p>Si tienes curiosidad en estas pruebas puedes visitar <a href="https://rpubs.com/aryn999/LinearRegressionAssumptionsAndDiagnosticsInR" target="_blank">este enlace.</a></p></li>
<li class="fragment"><p>De alguna manera podemos decir que de hecho, los estadísticos somos más laxos con la regresión lineal, sin embargo esto es bajo el supuesto no estadístico de que estas departuras de los supuestos fueran debidamente documentadas y plasmadas en los trabajos científicos, lo cual lamentablemente no pasa muy a menudo.</p></li>
<li class="fragment"><p>Existen por supuesto métodos que no dependen de todos estos supuestos (por ejemplo: regresiones lineales Bayesianas, modelos lineales generalizados correctamente parametrizados) pero no son parte de este curso.</p></li>
</ul>
</div>
</section>
<section id="transformación-de-datos" class="slide level2 scrollable smaller">
<h2>Transformación de datos</h2>
<div>
<ul>
<li class="fragment"><p>Al igual que en el ANOVA, podemos recurrir a transformaciones de datos que nos permitan aliviar varios de los supuestos no cumplidos de la regresión lineal.</p></li>
<li class="fragment"><p>En el presente caso, esto lo logramos al utilizar el logaritmo natural de las dos variables del modelo</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>lm6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SVL.final) <span class="sc">~</span> <span class="fu">log</span>(Age.DPO), <span class="at">data =</span> ranas)</span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb141-3"><a href="#cb141-3"></a><span class="fu">plot</span>(lm6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-112-1.png" width="576"></p>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb142-2"><a href="#cb142-2"></a><span class="fu">summary</span>(lm6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(SVL.final) ~ log(Age.DPO), data = ranas)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.182298 -0.049070  0.000516  0.038342  0.159057 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.44001    0.09211  37.345  &lt; 2e-16 ***
log(Age.DPO) -0.11624    0.02232  -5.208 1.58e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06244 on 76 degrees of freedom
Multiple R-squared:  0.263, Adjusted R-squared:  0.2533 
F-statistic: 27.12 on 1 and 76 DF,  p-value: 1.581e-06</code></pre>
</div>
</div>
</div>
</section>
<section id="interpretación-de-la-regresión-lineal" class="slide level2 smaller scrollable">
<h2>Interpretación de la regresión lineal</h2>
<div class="fragment">
<p><span class="math display">\[
y = mx + b
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(SVL.final) ~ log(Age.DPO), data = ranas)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.182298 -0.049070  0.000516  0.038342  0.159057 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.44001    0.09211  37.345  &lt; 2e-16 ***
log(Age.DPO) -0.11624    0.02232  -5.208 1.58e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06244 on 76 degrees of freedom
Multiple R-squared:  0.263, Adjusted R-squared:  0.2533 
F-statistic: 27.12 on 1 and 76 DF,  p-value: 1.581e-06</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Por cada incremento en una unidad del logaritmo de <code>Age.DPO</code>, tenemos una unidad en descenso del logaritmo de <code>SVL.final</code></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">ggplot</span>(ranas, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Age.DPO), <span class="at">y =</span> <span class="fu">log</span>(SVL.final))) <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-114-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="interpretación-de-la-regresión-lineal-1" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>Interpretación de la regresión lineal</h2>
<div>
<ul>
<li class="fragment"><p>Sin embargo una interpretación en la escala logarítmica no es completamente entendible, al menos para alguien ajeno al análisis que realizamos.</p></li>
<li class="fragment"><p>Podríamos hacer la retransformación de las variables a sus unidades originales y generar un gráfico de las predicciones. A la final se reduce a matemática básica.</p></li>
<li class="fragment"><p>Afortunadamente la librería <code>ggeffects</code> nos salva de ese dilema!</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb146-2"><a href="#cb146-2"></a>predicciones <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(lm6)</span>
<span id="cb146-3"><a href="#cb146-3"></a>predicciones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Age.DPO
# Predicted values of SVL.final

Age.DPO | Predicted |         95% CI
------------------------------------
     35 |     20.63 | [20.05, 21.23]
     50 |     19.79 | [19.46, 20.13]
     60 |     19.38 | [19.11, 19.65]
     75 |     18.88 | [18.57, 19.20]
     90 |     18.48 | [18.08, 18.90]
    105 |     18.16 | [17.66, 18.67]
    120 |     17.88 | [17.30, 18.48]
    145 |     17.49 | [16.79, 18.22]

attr(,"class")
[1] "ggalleffects" "list"        
attr(,"model.name")
[1] "lm6"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Y finalmente el gráfico de predicciones</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="fu">plot</span>(predicciones<span class="sc">$</span>Age.DPO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-116-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="antes-de-terminar" class="title-slide slide level1 center">
<h1>¡Antes de terminar!</h1>

</section>
<section id="es-r2-realmente-útil" class="slide level2">
<h2>¿Es <span class="math inline">\(R^2\)</span> realmente útil?</h2>

<img data-src="images/vieja.jpg" class="r-stretch quarto-figure-center"></section>
<section id="es-r2-realmente-útil-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>¿Es <span class="math inline">\(R^2\)</span> realmente útil?</h2>
<div>
<ul>
<li class="fragment"><p>Quizá muchos hayan escuchado que un <span class="math inline">\(R^2\)</span> cercano a 1 es “ideal” cuando realizamos una regresión lineal.</p></li>
<li class="fragment"><p>Hay incluso márgenes para un buen <span class="math inline">\(R^2\)</span> (algo así como que por encima del 80% es “bueno”, mayor al 90% es excelente).</p></li>
<li class="fragment"><p>En breve, <span class="math inline">\(R^2\)</span> <strong>NO ES NINGUNA DE LAS SIGUIENTES COSAS</strong>:</p>
<ul>
<li class="fragment"><p>Una métrica de bondad de ajuste<span class="fragment">: no nos dice si el modelo se ajusta bien a los datos.</span></p></li>
<li class="fragment"><p>Una métrica del error de predicción<span class="fragment">: no mide para nada que tan bueno es el modelo para predecir futuras observaciones.</span></p></li>
<li class="fragment"><p>Una métrica que permita comparar modelos usando variables transformadas<span class="fragment">: es común jugar a transformar los datos para ver de que manera se puede inflarlo.</span></p></li>
<li class="fragment"><p>Una métrica que permita que tan bien una variable explica otra<span class="fragment">: en el ejemplo que vimos, y en toda regresión lineal, si cambiamos el predictor por respuesta y viceversa, tendremos exactamente el mismo <span class="math inline">\(R^2\)</span></span></p></li>
</ul></li>
<li class="fragment"><p><span class="math inline">\(R^2\)</span> es simplemente una medida de la cantidad de variación que un modelo específico explica. <span class="fragment">¿Tiene alguna utilidad práctica?</span></p></li>
</ul>
</div>
</section>
<section id="es-r2-realmente-útil-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>¿Es <span class="math inline">\(R^2\)</span> realmente útil?</h2>
<div class="fragment">
<ul>
<li>He visto carnicerías de datos por inflar <span class="math inline">\(R^2\)</span> debido a su mala interpretación de la cual no se sabe su origen exacto (<a href="https://psycnet.apa.org/record/1946-01733-001" target="_blank">pero quizá aquí uno de tantos culpables perdidos en la historia</a>).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Acá les dejo unos cuantos recursos que pueden revisar en más detalle si les interesa:</p>
<ul>
<li><p><a href="https://www.jstor.org/stable/2111095?casa_token=F0Om3ZPkjE4AAAAA%3AvR0lcSXuNHICl21EYDAoXSerVhME0AO_ZvkzayO1vYT6R3cCM9Ooy6-P9Wa6AEZN1Gcm960rjGFM9JVA4AJc4lm-nswzYJxdtiKr03H4tbVMRW16e35TlA" target="_blank">El paper “How not to lie with Statistics: Avoiding common mistakes in Quantitative Political Science”</a> Un artículo extenso pero que contiene una sección dedicada a desmitificar esta mala práctica.</p></li>
<li><p><a href="https://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/10/lecture-10.pdf" target="_blank">Las notas de la clase del Prof.&nbsp;Cosma Shalizi de la Universidad Carnegie Mellon</a> donde hermosamente destruye los mitos en torno al <span class="math inline">\(R^2\)</span> citando fórmulas y principios estadísticos.</p></li>
<li><p><a href="https://data.library.virginia.edu/is-r-squared-useless/" target="_blank">Un blog de Clay Ford, consultor estadístico de la Universidad de Virginia</a> donde demuestra con R que valores de <span class="math inline">\(R^2\)</span> cercanos a 0 no necesariamente implican un mal modelo, ni valores cercanos 1 son indicativo de modelos destacados.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="funciones-y-librerías-en-esta-sesión" class="slide level2 smaller scrollable">
<h2>Funciones y librerías en esta sesión</h2>
<p><strong>Librerías</strong></p>
<ul>
<li><p><code>UsingR</code> y <code>datarium</code> contienen recursos de aprendizaje, tablas de datos básicamente.</p></li>
<li><p><code>rstatix</code> es una librería para llevar a cabo tests y pruebas estadísticas básicas basada en el funcionamiento del operador de cascada de <code>dplyr</code></p></li>
<li><p><code>car</code> contiene diversas funciones para llevar a cabo análisis estadísticos. Está desarrollado como material adicional de un libro.</p></li>
<li><p><code>ggeffects</code> ofrece funcionalidades de computación y visualización de medias marginales de una amplia diversidad de tipos de modelos.</p></li>
<li><p><code>emmeans</code> se especializa en proveer funciones para el cómputo y análisis relacionados de medias marginales de diversos modelos estadísticos. <code>multcomp</code> y <code>multcompView</code> ofrecen funciones para dar formato a resultados producidos por <code>emmeans</code>.</p></li>
<li><p><code>olsrr</code> ofrece varias pruebas estadísticas para modelos. En este módulo lo hemos usado únicamente para cómputo de pruebas de homocedasticidad de residuos.</p></li>
<li><p><code>ggpubr</code> es una librería que ofrece una sintaxis reducida para producir figuras de una manera más sencilla que el uso total de <code>ggplot2</code>.</p></li>
</ul>


<img src="images/icon.png" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false,"theme":"whiteboard","boardmarkerWidth":4},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1366,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>